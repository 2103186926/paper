# è·å–é«˜ç²¾åº¦ç»çº¬åº¦çš„ç½‘æ ¼æ•°æ®

```
Q:å¦‚ä½•ä½¿ç”¨pythonæ¥è·å¾—é«˜ç²¾åº¦çš„ç½‘æ ¼æ•°æ®
```

è·å–é«˜ç²¾åº¦çš„ç½‘æ ¼æ•°æ®ï¼ˆç»çº¬åº¦æ•°æ®ï¼‰åœ¨åœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼ˆGISï¼‰ã€æ°”è±¡ã€ç¯å¢ƒç§‘å­¦ã€äº¤é€šè¿è¾“ç­‰é¢†åŸŸéƒ½éå¸¸æœ‰ç”¨ã€‚æˆ‘å°†æŒ‡å¯¼ä½ å¦‚ä½•ä½¿ç”¨Pythonæ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚

## **ç½‘æ ¼æ•°æ®æ˜¯ä»€ä¹ˆï¼Ÿ**

ç½‘æ ¼æ•°æ®æ˜¯æŒ‡å°†åœ°çƒè¡¨é¢ï¼ˆæˆ–æŸä¸€åŒºåŸŸï¼‰æŒ‰ç…§ä¸€å®šçš„ç©ºé—´åˆ†è¾¨ç‡ï¼ˆä¾‹å¦‚0.01Â°Ã—0.01Â°ï¼‰åˆ’åˆ†æˆè§„åˆ™çš„æ ¼ç½‘ï¼Œæ¯ä¸ªæ ¼ç½‘å•å…ƒï¼ˆç½‘æ ¼ï¼‰éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç»çº¬åº¦åæ ‡ï¼ˆé€šå¸¸æ˜¯ç½‘æ ¼ä¸­å¿ƒç‚¹ï¼‰ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹æ¯ä¸ªç½‘æ ¼è¿›è¡Œæ•°æ®èµ‹å€¼ï¼ˆå¦‚æµ·æ‹”é«˜åº¦ã€æ¸©åº¦ã€äººå£å¯†åº¦ç­‰ï¼‰ã€‚

## **æ•°æ®æº**

è·å–é«˜ç²¾åº¦ç½‘æ ¼æ•°æ®æœ‰å‡ ä¸ªé€”å¾„ï¼š

1. **å¼€æºæ•°æ®é›†**ï¼š
        * NASAçš„[MERRA-2](https://gmao.gsfc.nasa.gov/reanalysis/MERRA-2/)ï¼ˆå…¨çƒæ°”è±¡æ•°æ®ï¼Œç½‘æ ¼åˆ†è¾¨ç‡çº¦0.5Â°Ã—0.625Â°ï¼‰
            * [GMTED2010](https://www.usgs.gov/centers/eros/science/usgs-eros-archive-digital-elevation-global-multi-resolution-terrain-elevation-data?qt-science_center_objects=0#qt-science_center_objects)ï¼ˆå…¨çƒåœ°å½¢é«˜ç¨‹æ•°æ®ï¼Œç½‘æ ¼åˆ†è¾¨ç‡çº¦7.5å¼§ç§’ï¼Œçº¦250ç±³ï¼‰
            * [WorldClim](https://www.worldclim.org/data/index.html)ï¼ˆå…¨çƒæ°”å€™æ•°æ®ï¼Œç½‘æ ¼åˆ†è¾¨ç‡æœ€é«˜çº¦30å¼§ç§’ï¼Œçº¦1å…¬é‡Œï¼‰
2. **å•†ä¸šæ•°æ®**ï¼š
        * [æ°”è±¡å±€æ•°æ®](https://www.ncdc.noaa.gov/cdo-web/)ï¼ˆå¦‚NOAAï¼Œéƒ¨åˆ†é«˜ç²¾åº¦æ•°æ®éœ€è¦ä»˜è´¹ï¼‰
        * [DigitalGlobe](https://www.maxar.com/)ï¼ˆé«˜åˆ†è¾¨ç‡å«æ˜Ÿå½±åƒï¼Œå•†ä¸šç”¨é€”æ”¶è´¹ï¼‰
3. **è‡ªå·±ç”Ÿæˆç½‘æ ¼**ï¼š
        * å¦‚æœä½ åªéœ€è¦ç»çº¬åº¦ç½‘æ ¼æ¡†æ¶ï¼Œè€Œä¸å…³å¿ƒå…·ä½“çš„æ•°æ®å€¼ï¼Œå¯ä»¥é€šè¿‡ç¼–ç¨‹è‡ªè¡Œç”Ÿæˆã€‚

æˆ‘ä»¬å…ˆä»‹ç»**æ–¹æ³•3ï¼šè‡ªå·±ç”Ÿæˆé«˜ç²¾åº¦ç½‘æ ¼**ï¼Œå› ä¸ºè¿™æœ€çµæ´»ä¸”å…è´¹ã€‚ä¹‹åï¼Œæˆ‘ä¼šç®€å•ä»‹ç»å¦‚ä½•è¯»å–å¼€æºæ•°æ®é›†ã€‚

| éœ€æ±‚               | å»ºè®®æ–¹æ³•                                            |
| ------------------ | --------------------------------------------------- |
| è‡ªå®šä¹‰ç»çº¬åº¦ç½‘æ ¼   | ä½¿ç”¨ `numpy.meshgrid` ç”Ÿæˆè§„åˆ™ç½‘æ ¼                  |
| è¯»å–å·²æœ‰é«˜ç²¾åº¦æ•°æ® | ä½¿ç”¨ `xarray`ã€`netCDF4` è¯»å– NetCDF æˆ– HDF æ•°æ®    |
| è·å–é«˜åˆ†åœ°ç†æ•°æ®   | åˆ©ç”¨ NASAã€NOAAã€Copernicusã€OpenStreetMap ç­‰æ•°æ®æº |

## âœ… æ•°æ®æºæ¨èï¼ˆé«˜ç²¾åº¦ç½‘æ ¼æ•°æ®ï¼‰

| æ•°æ®æº         | è¯´æ˜                                         | æ ¼å¼        | é“¾æ¥                              |
| -------------- | -------------------------------------------- | ----------- | --------------------------------- |
| NASA Earthdata | æä¾›MODISã€Sentinelç­‰é«˜åˆ†é¥æ„Ÿæ•°æ®            | HDF, NetCDF | https://earthdata.nasa.gov        |
| NOAA           | æä¾›æ°”è±¡ã€æµ·æ´‹ã€æ°”æ¸©ç­‰ç½‘æ ¼æ•°æ®               | NetCDF      | https://www.ncei.noaa.gov         |
| Copernicus     | æ¬§ç›Ÿçš„åœ°çƒè§‚æµ‹ç³»ç»Ÿï¼Œå«å¤§æ°”ã€åœŸåœ°ã€æµ·æ´‹ç­‰æ•°æ® | NetCDF      | https://cds.climate.copernicus.eu |
| OpenTopography | é«˜ç²¾åº¦åœ°å½¢æ•°æ®ï¼ˆDEMï¼‰                        | GeoTIFF     | https://opentopography.org        |

**æ–¹æ³•1ï¼šPythonç”Ÿæˆç»çº¬åº¦ç½‘æ ¼**
-------------------------------------

å‡è®¾æˆ‘ä»¬éœ€è¦å¯¹ä¸­å›½åŒºåŸŸï¼ˆç®€åŒ–èŒƒå›´ï¼šä¸œç»73Â°~135Â°ï¼ŒåŒ—çº¬15Â°~55Â°ï¼‰ç”Ÿæˆ **0.01Â°Ã—0.01Â°** é«˜ç²¾åº¦ç½‘æ ¼ã€‚

```python
import numpy as np
import pandas as pd

def create_lat_lon_grid(min_lat, max_lat, min_lon, max_lon, resolution=0.01):
    """
    ç”Ÿæˆç»çº¬åº¦ç½‘æ ¼
    
    Parameters:
    - min_lat, max_lat: çº¬åº¦èŒƒå›´ (å—çº¬ä¸ºè´Ÿ, åŒ—çº¬ä¸ºæ­£)
    - min_lon, max_lon: ç»åº¦èŒƒå›´ (è¥¿ç»ä¸ºè´Ÿ, ä¸œç»ä¸ºæ­£)
    - resolution: ç½‘æ ¼åˆ†è¾¨ç‡, å•ä½åº¦
    
    Returns:
    - DataFrame: æ¯è¡Œæ˜¯ä¸€ä¸ªç½‘æ ¼ä¸­å¿ƒç‚¹çš„ç»çº¬åº¦
    """
    # è®¡ç®—ç½‘æ ¼æ•°
    lat_num = int(np.ceil((max_lat - min_lat) / resolution))  # å‘ä¸Šå–æ•´
    lon_num = int(np.ceil((max_lon - min_lon) / resolution))
    
    # ç”Ÿæˆçº¬åº¦å’Œç»åº¦æ•°ç»„ï¼ˆç½‘æ ¼ä¸­å¿ƒç‚¹åæ ‡ï¼‰
    lat_centers = np.linspace(min_lat + resolution/2, max_lat - resolution/2, lat_num)
    lon_centers = np.linspace(min_lon + resolution/2, max_lon - resolution/2, lon_num)
    
    # ç½‘æ ¼åŒ–ï¼ˆç±»ä¼¼ meshgridï¼‰
    lon_grid, lat_grid = np.meshgrid(lon_centers, lat_centers)
    
    # å±•å¹³ä¸º 1 ç»´æ•°ç»„
    lons = lon_grid.flatten()
    lats = lat_grid.flatten()
    
    # è½¬ä¸º DataFrame æ–¹ä¾¿æŸ¥çœ‹å’Œå­˜å–
    df_grid = pd.DataFrame({
        'lat': lats,  # çº¬åº¦
        'lon': lons   # ç»åº¦
    })
    
    return df_grid

# ä¸­å›½åŒºåŸŸçš„ç»çº¬åº¦èŒƒå›´ï¼ˆç²—ç•¥ï¼‰
min_lat, max_lat = 15, 55  # åŒ—çº¬15Â°~55Â°
min_lon, max_lon = 73, 135  # ä¸œç»73Â°~135Â°

# åˆ†è¾¨ç‡ï¼š0.01 åº¦ï¼ˆçº¦ 1.1 å…¬é‡Œï¼‰
resolution = 0.01  

# ç”Ÿæˆç½‘æ ¼
grid_df = create_lat_lon_grid(min_lat, max_lat, min_lon, max_lon, resolution)

print(grid_df.head())  # æŸ¥çœ‹å‰5è¡Œ
print(f"æ€»ç½‘æ ¼æ•°: {len(grid_df)}")

# ä¿å­˜ä¸º CSV æ–‡ä»¶
grid_df.to_csv(f"China_grid_{resolution}.csv", index=False)
```

**è¿è¡Œç»“æœ**ï¼š
```
      lat     lon
0  15.005  73.005
1  15.005  73.015
2  15.005  73.025
3  15.005  73.035
4  15.005  73.045
æ€»ç½‘æ ¼æ•°: 1680000  # (4000 x 4200 ç½‘æ ¼æ•°ï¼Œ0.01Â°åˆ†è¾¨ç‡ä¸‹ä¸­å›½åŒºåŸŸçº¦æœ‰168ä¸‡ä¸ªç½‘æ ¼)
```

ç”Ÿæˆçš„CSVæ–‡ä»¶æ¯è¡Œæ˜¯ä¸€ä¸ªç½‘æ ¼ä¸­å¿ƒç‚¹çš„ç»çº¬åº¦ï¼Œç»“æ„å¦‚ä¸‹ï¼š

| lat    | lon     |
| ------ | ------- |
| 15.005 | 73.005  |
| 15.005 | 73.015  |
| ...    | ...     |
| 54.995 | 134.995 |

**ç½‘æ ¼ç²¾åº¦è§£é‡Š**ï¼š

- `resolution=0.01` è¡¨ç¤ºæ¯ä¸ªç½‘æ ¼çº¦ï¼š
  - çº¬åº¦æ–¹å‘ï¼š0.01Â° â‰ˆ **1.1å…¬é‡Œ**ï¼ˆå› ä¸º1Â°çº¬åº¦â‰ˆ111å…¬é‡Œï¼‰
  - ç»åº¦æ–¹å‘ï¼š0.01Â° â‰ˆ **0.64~1.1å…¬é‡Œ**ï¼ˆèµ¤é“é™„è¿‘1Â°â‰ˆ111å…¬é‡Œï¼Œçº¬åº¦è¶Šé«˜è¶Šçª„ï¼‰

**æ€»ç»“**ï¼š

1. **çº¯Pythonç”Ÿæˆç½‘æ ¼**ï¼šé€‚ç”¨äº**ä¸éœ€è¦çœŸå®æ•°æ®å€¼**ï¼Œåªæƒ³è¦**ç»çº¬åº¦æ¡†æ¶**çš„åœºæ™¯ï¼ˆå¦‚ç»™æ¨¡å‹åšç»çº¬åº¦åŒ¹é…ã€ç”Ÿæˆé‡‡æ ·ç‚¹ç­‰ï¼‰ã€‚ä»£ç çµæ´»å¯æ§ã€‚
2. **è¯»å–GeoTIFFæ …æ ¼æ•°æ®**ï¼šé€‚ç”¨äºå·²æœ‰**é«˜ç¨‹ã€æ°”æ¸©ã€é™æ°´ã€åœŸåœ°åˆ©ç”¨ç­‰**çœŸå®æ•°æ®çš„åœºæ™¯ï¼ˆå¦‚ç§‘ç ”ç»˜å›¾ã€æœºå™¨å­¦ä¹ ç‰¹å¾å·¥ç¨‹ï¼‰ã€‚



ä¸€ä¸ªéå¸¸å¥½çš„é—®é¢˜ï¼è·å–é«˜ç²¾åº¦çš„ç½‘æ ¼æ•°æ®ï¼ˆç»çº¬åº¦æ•°æ®ï¼‰åœ¨åœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼ˆGISï¼‰ã€æ°”è±¡ã€ç¯å¢ƒç§‘å­¦ã€äº¤é€šè¿è¾“ç­‰é¢†åŸŸéƒ½éå¸¸æœ‰ç”¨ã€‚Python æ˜¯å¤„ç†è¿™ç±»æ•°æ®çš„ç»ä½³å·¥å…·ã€‚ä¸‹é¢æˆ‘ä¼šè¯¦ç»†ä»‹ç» **è·å–é«˜ç²¾åº¦ç»çº¬åº¦ç½‘æ ¼æ•°æ®** çš„æ–¹æ³•ï¼Œå¹¶æä¾›å…·ä½“çš„å®ç°ä»£ç ã€‚

## **1. æ˜ç¡®ä½ çš„éœ€æ±‚**
åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆæ˜ç¡®å‡ ä¸ªé—®é¢˜ï¼š
1. **è¦†ç›–èŒƒå›´**ï¼šå…¨çƒï¼Ÿä¸­å›½ï¼ŸæŸä¸ªåŸå¸‚ï¼Ÿ
2. **ç½‘æ ¼ç²¾åº¦ï¼ˆåˆ†è¾¨ç‡ï¼‰**ï¼š  
   - ç²—ç•¥ï¼š`1Â° Ã— 1Â°`ï¼ˆçº¦ 100km ç½‘æ ¼ï¼‰  
   - ä¸­ç­‰ï¼š`0.1Â° Ã— 0.1Â°`ï¼ˆçº¦ 10km ç½‘æ ¼ï¼‰  
   - ç²¾ç»†ï¼š`0.01Â° Ã— 0.01Â°`ï¼ˆçº¦ 1km ç½‘æ ¼ï¼‰  
   - é«˜ç²¾ï¼š`0.001Â° Ã— 0.001Â°`ï¼ˆçº¦ 100ç±³ç½‘æ ¼ï¼‰
3. **æ•°æ®æ ¼å¼**ï¼šCSVã€GeoJSONã€NetCDF è¿˜æ˜¯ DataFrameï¼Ÿ
4. **æ˜¯å¦éœ€è¦æŠ•å½±åæ ‡ç³»**ï¼Ÿï¼ˆå¦‚ UTMã€å…°ä¼¯ç‰¹æŠ•å½±ï¼‰

è¿™é‡Œæˆ‘ä»¬ä»¥ **ç”Ÿæˆå…¨çƒ 0.01Â°Ã—0.01Â°ï¼ˆçº¦ 1kmÃ—1kmï¼‰ç»çº¬åº¦ç½‘æ ¼** ä¸ºä¾‹ï¼Œç»“æœä¿å­˜ä¸º **CSV** æ ¼å¼ã€‚

## **2. æ ¸å¿ƒæ€è·¯**
ç”Ÿæˆç½‘æ ¼æ•°æ®çš„é€»è¾‘å¾ˆç®€å•ï¼š
1. ç¡®å®š **ç»åº¦èŒƒå›´** (`-180Â° ~ 180Â°`) å’Œ **çº¬åº¦èŒƒå›´** (`-90Â° ~ 90Â°`)ã€‚
2. è®¾å®š **æ­¥é•¿ï¼ˆstepï¼‰**ï¼Œå¦‚ `0.01` è¡¨ç¤ºæ¯éš” 0.01 åº¦ç”Ÿæˆä¸€ä¸ªç½‘æ ¼ç‚¹ã€‚
3. ç»„åˆ **æ¯ä¸ªç»åº¦** å’Œ **æ¯ä¸ªçº¬åº¦**ï¼Œå½¢æˆ `(lon, lat)` ç‚¹å¯¹ã€‚
4. å¯é€‰ï¼šè®¡ç®—ç½‘æ ¼çš„ **å››è§’åæ ‡**ï¼ˆè‹¥éœ€è¦çŸ©å½¢ç½‘æ ¼é¢ç‰‡ï¼‰ã€‚

## **3. Python å®ç°ä»£ç **

ä»¥ä¸‹æ˜¯ç”Ÿæˆ **å…¨çƒ 0.01Â° ç½‘æ ¼** å¹¶ä¿å­˜ä¸º CSV çš„ä»£ç ï¼š
```python
import numpy as np
import pandas as pd

def generate_lat_lon_grid(step=0.01, save_path='global_grid_0.01deg.csv'):
    """
    ç”Ÿæˆå…¨çƒç»çº¬åº¦ç½‘æ ¼
    :param step: ç½‘æ ¼æ­¥é•¿ï¼Œå•ä½åº¦ï¼ˆä¾‹å¦‚ 0.01 â‰ˆ 1kmï¼‰
    :param save_path: ä¿å­˜CSVè·¯å¾„
    """
    # 1. å®šä¹‰ç»çº¬åº¦èŒƒå›´
    lon_min, lon_max = -180, 180  # ç»åº¦èŒƒå›´
    lat_min, lat_max = -90, 90    # çº¬åº¦èŒƒå›´

    # 2. ç”Ÿæˆç»çº¬åº¦åºåˆ—ï¼ˆé—­åŒºé—´ï¼‰
    lon_values = np.arange(lon_min, lon_max + step, step)  # +step ä¿è¯åŒ…å«å³ç«¯ç‚¹
    lat_values = np.arange(lat_min, lat_max + step, step)

    # 3. ç½‘æ ¼åŒ–ï¼ˆä½¿ç”¨ meshgrid æˆ–å¾ªç¯ï¼‰
    lon_grid, lat_grid = np.meshgrid(lon_values, lat_values)
    lon_flat = lon_grid.flatten()  # å±•å¹³ä¸º1ç»´
    lat_flat = lat_grid.flatten()

    # 4. è½¬ä¸º DataFrame
    df_grid = pd.DataFrame({
        'longitude': lon_flat,  # ç»åº¦
        'latitude': lat_flat    # çº¬åº¦
    })

    # 5. è®¡ç®—ç½‘æ ¼é¢ç§¯ï¼ˆå¯é€‰ï¼Œå•ä½ï¼šå¹³æ–¹å…¬é‡Œï¼‰
    # ç²—ç•¥å…¬å¼ï¼š1Â° â‰ˆ 111kmï¼Œçº¬åº¦æ–¹å‘å›ºå®šï¼Œç»åº¦æ–¹å‘éšçº¬åº¦å˜åŒ–
    df_grid['approx_area_km2'] = (111 * step) * (111 * np.cos(np.radians(lat_flat)) * step)

    # 6. ä¿å­˜ä¸ºCSV
    df_grid.to_csv(save_path, index=False)
    print(f"ç½‘æ ¼æ•°æ®å·²ä¿å­˜ï¼š{save_path}")
    print(f"æ€»ç½‘æ ¼ç‚¹æ•°ï¼š{len(df_grid)}")

# ç¤ºä¾‹ï¼šç”Ÿæˆ 0.01Â° å…¨çƒç½‘æ ¼ï¼ˆçº¦ 1km ç²¾åº¦ï¼‰
generate_lat_lon_grid(step=0.01, save_path='global_1km_grid.csv')
```
**è¿è¡Œç»“æœ**ï¼š  
- ç”Ÿæˆ `global_1km_grid.csv`ï¼ŒåŒ…å« **ç»åº¦(longitude)ã€çº¬åº¦(latitude)ã€è¿‘ä¼¼é¢ç§¯(approx_area_km2)** ä¸‰åˆ—ã€‚
- ç½‘æ ¼ç‚¹æ•° â‰ˆ `(360/0.01) Ã— (180/0.01) = 36,000 Ã— 18,000 = **6.48äº¿ä¸ªç‚¹**`ï¼ˆæ–‡ä»¶çº¦ 25GBï¼Œè°¨æ…è¿è¡Œï¼ï¼‰
- è‹¥æ”¹ä¸º `step=0.1`ï¼Œåˆ™åªæœ‰ **648ä¸‡ç‚¹**ï¼Œæ–‡ä»¶çº¦ 250MBã€‚

**CSV æ–‡ä»¶é¢„è§ˆ**ï¼š
| longitude | latitude | approx_area_km2 |
| --------- | -------- | --------------- |
| -180.0    | 90.0     | 0.0             |
| -179.99   | 90.0     | 0.0             |
| -179.98   | 90.0     | 0.0             |
| ...       | ...      | ...             |
| 180.0     | -90.0    | 0.0             |

## **4. ä¼˜åŒ–ï¼šé™å®šä¸­å›½åŒºåŸŸç½‘æ ¼**
ä¸æƒ³ç”Ÿæˆå…¨çƒæ•°æ®ï¼Ÿåªéœ€ **ç¼©å°ç»çº¬åº¦èŒƒå›´** å³å¯ã€‚  
**ä¸­å›½èŒƒå›´**ï¼š`lon: 73Â°~135Â°`ã€`lat: 15Â°~55Â°`  
ä¿®æ”¹ä»£ç ï¼š

```python
def generate_china_grid(step=0.01, save_path='china_grid_0.01deg.csv'):
    lon_min, lon_max = 73, 135   # ä¸­å›½ç»åº¦èŒƒå›´
    lat_min, lat_max = 15, 55    # ä¸­å›½çº¬åº¦èŒƒå›´
    lon_values = np.arange(lon_min, lon_max + step, step)
    lat_values = np.arange(lat_min, lat_max + step, step)
    lon_grid, lat_grid = np.meshgrid(lon_values, lat_values)
    lon_flat, lat_flat = lon_grid.flatten(), lat_grid.flatten()
    
    df_grid = pd.DataFrame({
        'longitude': lon_flat,
        'latitude': lat_flat
    })
    df_grid['approx_area_km2'] = (111 * step) * (111 * np.cos(np.radians(lat_flat)) * step)
    df_grid.to_csv(save_path, index=False)
    print(f"ä¸­å›½ç½‘æ ¼æ•°æ®å·²ä¿å­˜ï¼š{save_path}, æ€»ç‚¹æ•°ï¼š{len(df_grid)}")

generate_china_grid(step=0.01, save_path='china_1km_grid.csv')
```
**ç‚¹æ•°ä¼°ç®—**ï¼š  

- `(135-73)/0.01 Ã— (55-15)/0.01 = 6200 Ã— 4000 = 2480ä¸‡ç‚¹`  
- æ–‡ä»¶å¤§å°çº¦ **1GB**ï¼Œéå¸¸é€‚åˆæ™®é€šç”µè„‘å¤„ç†ã€‚

## **5. è¿›é˜¶ç©æ³•**
### ï¼ˆ1ï¼‰è½¬ä¸º GeoJSONï¼ˆGIS çŸ¢é‡æ ¼å¼ï¼‰
è‹¥éœ€åœ¨ **QGISã€ArcGISã€OpenLayers** ä¸­å¯è§†åŒ–ï¼š
```python
import geopandas as gpd
from shapely.geometry import Point

df = pd.read_csv('china_1km_grid.csv')
geometry = [Point(lon, lat) for lon, lat in zip(df.longitude, df.latitude)]
gdf = gpd.GeoDataFrame(df, geometry=geometry, crs='EPSG:4326')  # WGS84åæ ‡ç³»
gdf.to_file('china_1km_grid.geojson', driver='GeoJSON')
```
æ‰“å¼€ **QGIS** å¯¼å…¥ GeoJSONï¼Œå°±èƒ½çœ‹åˆ° **1kmÃ—1km çš„ç‚¹ç½‘æ ¼**ã€‚

### ï¼ˆ2ï¼‰ç”»ç½‘æ ¼çŸ©å½¢ï¼ˆé¢æ•°æ®ï¼‰
ä¸æƒ³ç”¨ç‚¹ï¼Œæƒ³ç”» **ç½‘æ ¼æ–¹æ ¼**ï¼Ÿ  
```python
import geopandas as gpd
from shapely.geometry import Polygon

step = 0.01
polygons = []
for lon in np.arange(73, 135, step):
    for lat in np.arange(15, 55, step):
        # æ„å»ºçŸ©å½¢ï¼š(lon, lat) -> (lon+step, lat+step)
        rect = Polygon([
            (lon, lat),
            (lon + step, lat),
            (lon + step, lat + step),
            (lon, lat + step),
            (lon, lat)  # é—­åˆ
        ])
        polygons.append(rect)

gdf = gpd.GeoDataFrame(geometry=polygons, crs='EPSG:4326')
gdf.to_file('china_1km_grid_rect.geojson', driver='GeoJSON')
```
è¿™æ ·ç”Ÿæˆçš„æ˜¯ **é¢ç½‘æ ¼**ï¼Œè€Œä¸æ˜¯ç‚¹ï¼Œåœ¨ GIS è½¯ä»¶ä¸­å¯ç”¨äº **åŒºåŸŸç»Ÿè®¡ã€è£å‰ªåˆ†æ**ã€‚

## **6. æ€»ç»“**
| ç½‘æ ¼ç²¾åº¦ | æ­¥é•¿(step) | å…¨çƒç½‘æ ¼ç‚¹æ•° | ä¸­å›½ç½‘æ ¼ç‚¹æ•° | æ–‡ä»¶å¤§å°(çº¦) |
| -------- | ---------- | ------------ | ------------ | ------------ |
| 10km     | 0.1Â°       | 648 ä¸‡       | 6.2 ä¸‡       | 250 MB       |
| 1km      | 0.01Â°      | **6.48 äº¿**  | **2480 ä¸‡**  | 1GB (ä¸­å›½)   |
| 100m     | 0.001Â°     | 648 äº¿       | 2.48 äº¿      | 100GB (ä¸­å›½) |

**å…³é”®ç‚¹**ï¼š

1. ç”¨ `numpy.arange` ç”Ÿæˆç»çº¬åº¦åºåˆ—ã€‚
2. `np.meshgrid` æ„å»ºç½‘æ ¼ï¼Œ`.flatten()` å±•å¹³ä¸ºç‚¹é›†ã€‚

```
Q:æˆ‘æƒ³ä½¿ç”¨pythonè‡ªå·±ç”Ÿæˆç½‘æ ¼æ¥è·å–é«˜ç²¾åº¦çš„ç½‘æ ¼æ•°æ®ï¼ˆç»çº¬åº¦æ•°æ®ï¼‰ï¼Œè¯·é—®æˆ‘è¦æ€ä¹ˆåšï¼Ÿ
```

éå¸¸å¥½çš„æƒ³æ³•ï¼è‡ªå·±ç”Ÿæˆç½‘æ ¼æ•°æ®å¯ä»¥è®©ä½ å®Œå…¨æŒæ§ç½‘æ ¼çš„ç²¾åº¦å’ŒèŒƒå›´ï¼Œéå¸¸é€‚åˆéœ€è¦é«˜ç²¾åº¦ç»çº¬åº¦æ•°æ®çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚æ°”è±¡åˆ†æã€åœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼ˆGISï¼‰ã€ç¯å¢ƒç§‘å­¦ç­‰ã€‚ä¸‹é¢æˆ‘ä¼šä¸€æ­¥æ­¥æŒ‡å¯¼ä½ å¦‚ä½•ä½¿ç”¨Pythonç”Ÿæˆé«˜ç²¾åº¦çš„ç½‘æ ¼æ•°æ®ï¼ˆç»çº¬åº¦ç½‘æ ¼ï¼‰ã€‚

**ç›®æ ‡**ï¼šç”Ÿæˆä¸€ä¸ªå…¨çƒæˆ–è€…æŒ‡å®šåŒºåŸŸçš„ç»çº¬åº¦ç½‘æ ¼æ•°æ®ï¼Œæ¯ä¸ªç½‘æ ¼ç‚¹åŒ…å«ç»åº¦ï¼ˆLongitudeï¼‰å’Œçº¬åº¦ï¼ˆLatitudeï¼‰ä¿¡æ¯ã€‚

**éœ€è¦çš„å·¥å…·åº“**ï¼š

1. **`numpy`**ï¼šç”¨äºæ•°å€¼è®¡ç®—ï¼Œç”Ÿæˆå‡åŒ€é—´éš”çš„ç»çº¬åº¦åºåˆ—ã€‚
2. **`pandas`**ï¼šå¯é€‰ï¼Œç”¨äºå°†ç½‘æ ¼æ•°æ®ä¿å­˜ä¸ºè¡¨æ ¼å½¢å¼ï¼ˆ`.csv`ç­‰ï¼‰ã€‚
3. **`matplotlib` æˆ– `cartopy`**ï¼šå¯é€‰ï¼Œç”¨äºå¯è§†åŒ–ç”Ÿæˆçš„ç½‘æ ¼ï¼ˆç»˜åˆ¶åœ°å›¾ï¼‰ã€‚

**æ­¥éª¤è¯¦è§£**ï¼š

---

### **Step 1ï¼šç¡®å®šç½‘æ ¼èŒƒå›´å’Œåˆ†è¾¨ç‡**
é¦–å…ˆï¼Œä½ éœ€è¦æ˜ç¡®ä»¥ä¸‹å‚æ•°ï¼š
- **ç ”ç©¶åŒºåŸŸ**ï¼š
  - å…¨çƒï¼šç»åº¦èŒƒå›´ `[-180Â°, 180Â°]`ï¼Œçº¬åº¦èŒƒå›´ `[-90Â°, 90Â°]`ã€‚
  - å±€éƒ¨åŒºåŸŸï¼ˆä¾‹å¦‚ä¸­å›½ï¼‰ï¼šç»åº¦èŒƒå›´ `[73Â°, 135Â°]`ï¼Œçº¬åº¦èŒƒå›´ `[15Â°, 55Â°]`ã€‚
- **ç½‘æ ¼åˆ†è¾¨ç‡**ï¼ˆå³ç½‘æ ¼ç‚¹çš„é—´è·ï¼Œå†³å®šäº†â€œç²¾åº¦â€ï¼‰ï¼š
  - ç²—åˆ†è¾¨ç‡ï¼š`1Â° Ã— 1Â°`ï¼ˆçº¦111å…¬é‡ŒÃ—111å…¬é‡Œï¼‰ã€‚
  - ä¸­ç­‰åˆ†è¾¨ç‡ï¼š`0.1Â° Ã— 0.1Â°`ï¼ˆçº¦10å…¬é‡ŒÃ—10å…¬é‡Œï¼‰ã€‚
  - é«˜åˆ†è¾¨ç‡ï¼š`0.01Â° Ã— 0.01Â°`ï¼ˆçº¦1å…¬é‡ŒÃ—1å…¬é‡Œï¼‰ã€‚
  - æé«˜åˆ†è¾¨ç‡ï¼š`0.001Â° Ã— 0.001Â°`ï¼ˆçº¦100ç±³Ã—100ç±³ï¼‰ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š
- å¦‚æœä½ è¦ç”Ÿæˆ **å…¨çƒ 0.1Â° Ã— 0.1Â° ç½‘æ ¼**ï¼š
  - ç»åº¦æ–¹å‘ï¼šä» `-180.0` åˆ° `180.0`ï¼Œæ¯éš” `0.1` ç”Ÿæˆä¸€ä¸ªç‚¹ã€‚
  - çº¬åº¦æ–¹å‘ï¼šä» `-90.0` åˆ° `90.0`ï¼Œæ¯éš” `0.1` ç”Ÿæˆä¸€ä¸ªç‚¹ã€‚

---

### **Step 2ï¼šç”¨ NumPy ç”Ÿæˆç»çº¬åº¦ç½‘æ ¼**
æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```python
import numpy as np
import pandas as pd

def generate_grid(min_lon, max_lon, min_lat, max_lat, resolution):
    """
    ç”Ÿæˆç»çº¬åº¦ç½‘æ ¼
    :param min_lon, max_lon: ç»åº¦èŒƒå›´ (æœ€å°, æœ€å¤§)
    :param min_lat, max_lat: çº¬åº¦èŒƒå›´ (æœ€å°, æœ€å¤§)
    :param resolution: ç½‘æ ¼åˆ†è¾¨ç‡ (ä¾‹å¦‚ 0.1 è¡¨ç¤º 0.1Â°Ã—0.1Â°)
    :return: ç½‘æ ¼ç‚¹çš„ç»çº¬åº¦åˆ—è¡¨
    """
    # ç”Ÿæˆç»åº¦åºåˆ—å’Œçº¬åº¦åºåˆ—
    lons = np.arange(min_lon, max_lon + resolution, resolution)  # +resolutionç¡®ä¿åŒ…å«å³ç«¯ç‚¹
    lats = np.arange(min_lat, max_lat + resolution, resolution)
    
    # ä½¿ç”¨ meshgrid ç”Ÿæˆç½‘æ ¼ç‚¹
    lon_grid, lat_grid = np.meshgrid(lons, lats)
    
    # å±•å¹³ä¸º1ç»´æ•°ç»„ï¼ˆæ–¹ä¾¿ä¿å­˜ä¸ºè¡¨æ ¼ï¼‰
    lon_flat = lon_grid.flatten()
    lat_flat = lat_grid.flatten()
    
    # æ‰“åŒ…æˆ DataFrameï¼ˆå¯é€‰ï¼Œä½†å¾ˆæ–¹ä¾¿ï¼‰
    df = pd.DataFrame({
        'longitude': lon_flat,
        'latitude': lat_flat
    })
    
    return df

# ç¤ºä¾‹1ï¼šç”Ÿæˆå…¨çƒ0.5Â°åˆ†è¾¨ç‡ç½‘æ ¼
global_grid = generate_grid(min_lon=-180, max_lon=180, 
                            min_lat=-90, max_lat=90, 
                            resolution=0.5)
print(global_grid.head())

# ç¤ºä¾‹2ï¼šç”Ÿæˆä¸­å›½åŒºåŸŸ 0.1Â° é«˜ç²¾åº¦ç½‘æ ¼
china_grid = generate_grid(min_lon=73, max_lon=135, 
                           min_lat=15, max_lat=55, 
                           resolution=0.1)
print(china_grid.shape)  # æŸ¥çœ‹æœ‰å¤šå°‘ä¸ªç½‘æ ¼ç‚¹
```

**è§£é‡Š**ï¼š
1. `np.arange(min, max + step, step)`ï¼šç”Ÿæˆä» `min` åˆ° `max` çš„ç­‰é—´éš”åºåˆ—ï¼ˆæ³¨æ„è¦ `+step`ï¼Œå¦åˆ™ä¼šå°‘æœ€åä¸€ä¸ªç‚¹ï¼‰ã€‚
2. `np.meshgrid(lons, lats)`ï¼šç”ŸæˆäºŒç»´ç½‘æ ¼çŸ©é˜µã€‚
   - ä¾‹å¦‚ `lons = [100, 101, 102]`ï¼Œ`lats = [30, 31]`ï¼Œåˆ™ï¼š
     - `lon_grid = [[100, 101, 102], [100, 101, 102]]`
     - `lat_grid = [[30, 30, 30], [31, 31, 31]]`
3. `.flatten()`ï¼šå°†äºŒç»´ç½‘æ ¼å±•å¹³æˆä¸€ç»´æ•°ç»„ï¼ˆè¿™æ ·æ¯ä¸ªç»çº¬åº¦ç‚¹éƒ½å˜æˆä¸€è¡Œï¼Œæ–¹ä¾¿å­˜è¡¨æ ¼ï¼‰ã€‚
4. ç”¨ `pandas.DataFrame` ä¿å­˜æ•°æ®ï¼Œå¯ä»¥ç›´æ¥è¾“å‡ºä¸º `.csv` æ–‡ä»¶ï¼š
   ```python
   china_grid.to_csv('china_grid_0.1deg.csv', index=False)
   ```

---

### **Step 3ï¼šä¿å­˜ç½‘æ ¼æ•°æ®**
ç”Ÿæˆç½‘æ ¼åï¼Œä½ å¯èƒ½æƒ³ä¿å­˜ä¸ºæ–‡ä»¶ï¼Œæ”¯æŒçš„æ ¼å¼æœ‰ï¼š
- **CSV**ï¼šé€šç”¨è¡¨æ ¼æ ¼å¼ï¼ŒExcelã€QGISã€MATLABéƒ½æ”¯æŒã€‚
  ```python
  china_grid.to_csv('china_0.1deg_grid.csv', index=False, float_format='%.6f')
  ```
- **NetCDF (.nc)**ï¼šé€‚åˆå¤§æ•°æ®ã€å¤šç»´æ•°æ®å­˜å‚¨ï¼ˆå¸¸ç”¨äºæ°”è±¡ã€æµ·æ´‹æ•°æ®ï¼‰ã€‚
  ```python
  import xarray as xr
  ds = xr.Dataset(
      data_vars={'longitude': (('grid_points',), china_grid['longitude'].values),
                 'latitude':  (('grid_points',), china_grid['latitude'].values)},
      coords={'grid_points': np.arange(len(china_grid))})
  ds.to_netcdf('china_grid_0.1deg.nc')
  ```
- **Shapefile (.shp)**ï¼šGISå¸¸ç”¨çŸ¢é‡æ ¼å¼ï¼ˆæ¯ä¸ªç‚¹å˜æˆä¸€ä¸ªè¦ç´ ï¼‰ã€‚
  ```python
  import geopandas as gpd
  geometry = gpd.points_from_xy(china_grid.longitude, china_grid.latitude)
  gdf = gpd.GeoDataFrame(china_grid, geometry=geometry, crs='EPSG:4326')
  gdf.to_file('china_grid_0.1deg.shp')
  ```

---

### **Step 4ï¼šå¯è§†åŒ–ç½‘æ ¼ï¼ˆå¯é€‰ï¼‰**
ä¸ºäº†æ£€æŸ¥ç½‘æ ¼å¯¹ä¸å¯¹ï¼Œå¯ä»¥ç”»å‡ºæ¥ï¼š
```python
import matplotlib.pyplot as plt
import cartopy.crs as ccrs
import cartopy.feature as cfeature

def plot_grid(df):
    fig = plt.figure(figsize=(10, 6))
    ax = fig.add_subplot(1, 1, 1, projection=ccrs.PlateCarree())
    ax.add_feature(cfeature.LAND, color='lightgray')
    ax.add_feature(cfeature.COASTLINE)
    ax.add_feature(cfeature.BORDERS, linestyle=':')
    ax.scatter(df.longitude, df.latitude, s=1, color='blue', alpha=0.5, transform=ccrs.PlateCarree())
    ax.set_extent([73, 135, 15, 55])  # ä¸­å›½åŒºåŸŸ
    ax.set_title('China 0.1Â° Grid')
    plt.show()

plot_grid(china_grid)
```
**æ•ˆæœ**ï¼šåœ°å›¾ä¸Šå¯†å¯†éº»éº»çš„è“ç‚¹å°±æ˜¯ç½‘æ ¼ã€‚

---

### **åˆ†è¾¨ç‡ä¸æ•°æ®é‡æç¤º**
| åˆ†è¾¨ç‡          | å…¨çƒç½‘æ ¼ç‚¹æ•°       | ä¸­å›½åŒºåŸŸç½‘æ ¼ç‚¹æ•°  |
| --------------- | ------------------ | ----------------- |
| `1Â°Ã—1Â°`         | çº¦ 64,800          | çº¦ 3,900          |
| `0.1Â°Ã—0.1Â°`     | çº¦ 6,480,000       | çº¦ 390,000        |
| `0.01Â°Ã—0.01Â°`   | çº¦ **648,000,000** | çº¦ **39,000,000** |
| `0.001Â°Ã—0.001Â°` | çº¦ **64.8äº¿**      | çº¦ **3.9äº¿**      |

- å¦‚æœç”Ÿæˆ `0.01Â°` å…¨çƒç½‘æ ¼ï¼ŒCSVæ–‡ä»¶å¯èƒ½è¶… **50GB**ï¼
- æ‰€ä»¥ï¼š
  - å±€éƒ¨åŒºåŸŸå¯ä»¥ç”¨é«˜ç²¾åº¦ï¼ˆå¦‚ `0.001Â°`ï¼‰ã€‚
  - å…¨çƒèŒƒå›´ `0.1Â°` è¶³å¤Ÿå¤§å¤šæ•°ç ”ç©¶ã€‚
  - æ•°æ®å¤ªå¤§æ—¶ï¼Œç”¨ `.nc` æ ¼å¼æ¯” `.csv` èŠ‚çœç©ºé—´ã€‚

---

### **æ€»ç»“æ­¥éª¤**
1. ç¡®å®š**ç ”ç©¶åŒºåŸŸ**ï¼ˆå…¨çƒ/å±€éƒ¨ï¼‰å’Œ**ç½‘æ ¼åˆ†è¾¨ç‡**ï¼ˆå¦‚ `0.1Â°`ï¼‰ã€‚
2. ç”¨ `numpy.arange` + `np.meshgrid` ç”Ÿæˆç»çº¬åº¦äºŒç»´ç½‘æ ¼ã€‚
3. å±•å¹³ä¸º1ç»´ï¼Œå­˜å…¥ `pandas.DataFrame`ã€‚
4. ä¿å­˜ä¸º `.csv` (é€šç”¨) / `.nc` (å¤§æ•°æ®) / `.shp` (GIS)ã€‚
5. ç”¨ `cartopy` å¯è§†åŒ–æ£€æŸ¥ç½‘æ ¼ã€‚

ç°åœ¨ï¼Œè¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ å°±æ‹¥æœ‰äº†**é«˜ç²¾åº¦ç»çº¬åº¦ç½‘æ ¼æ•°æ®**ï¼å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿è¿½é—®ï½



```
Q:æˆ‘æƒ³ä½¿ç”¨pythonè‡ªå·±ç”Ÿæˆç½‘æ ¼æ¥è·å–é«˜ç²¾åº¦çš„ç½‘æ ¼æ•°æ®ï¼ˆç»çº¬åº¦æ•°æ®ï¼‰ï¼ŒèŒƒå›´æ˜¯ä¸­å›½ï¼Œç²¾åº¦0.01ï¼Œè¯·é—®æˆ‘è¦æ€ä¹ˆåšï¼Ÿ
```

ä¸€ä¸ªéå¸¸æ£’çš„æƒ³æ³•ï¼è‡ªå·±ç”Ÿæˆç½‘æ ¼æ•°æ®å¯ä»¥æ»¡è¶³ç‰¹å®šç²¾åº¦éœ€æ±‚ï¼Œè€Œä¸”éå¸¸çµæ´»ã€‚ä¸‹é¢æˆ‘ä¼šä¸€æ­¥ä¸€æ­¥æŒ‡å¯¼ä½ å¦‚ä½•ä½¿ç”¨Pythonç”Ÿæˆä¸­å›½åŒºåŸŸå†…0.01Â°ç²¾åº¦çš„ç»çº¬åº¦ç½‘æ ¼æ•°æ®ã€‚

**1. ç¡®å®šä¸­å›½åŒºåŸŸçš„ç»çº¬åº¦è¾¹ç•Œ**

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸­å›½çš„ç»çº¬åº¦èŒƒå›´ï¼Œå¤§çº¦æ˜¯ï¼š
- ç»åº¦ï¼ˆLongitudeï¼‰ï¼š73Â°E ~ 135Â°E ï¼ˆä¸œç»ï¼‰
- çº¬åº¦ï¼ˆLatitudeï¼‰ï¼š3Â°N ~ 53Â°N ï¼ˆåŒ—çº¬ï¼‰

**2. å®šä¹‰ç½‘æ ¼ç²¾åº¦**

ä½ è¦æ±‚çš„ç²¾åº¦æ˜¯ **0.01Â°**ï¼Œæ„å‘³ç€ï¼š
- ç»åº¦æ–¹å‘ï¼ˆä¸œè¥¿æ–¹å‘ï¼‰ï¼šæ¯éš”0.01Â°ç”Ÿæˆä¸€ä¸ªç‚¹
- çº¬åº¦æ–¹å‘ï¼ˆå—åŒ—æ–¹å‘ï¼‰ï¼šæ¯éš”0.01Â°ç”Ÿæˆä¸€ä¸ªç‚¹

**3. è®¡ç®—ç½‘æ ¼ç‚¹çš„æ•°é‡**

æ ¹æ®ç²¾åº¦è¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºéœ€è¦ç”Ÿæˆçš„ç½‘æ ¼ç‚¹æ•°é‡ï¼š
- ç»åº¦èŒƒå›´ï¼š`135 - 73 = 62Â°`
  - ç½‘æ ¼ç‚¹æ•°ï¼š`62 / 0.01 + 1 = 6201` ä¸ªç‚¹ï¼ˆåŠ 1æ˜¯å› ä¸ºåŒ…å«è¾¹ç•Œç‚¹ï¼‰
- çº¬åº¦èŒƒå›´ï¼š`53 - 3 = 50Â°`
  - ç½‘æ ¼ç‚¹æ•°ï¼š`50 / 0.01 + 1 = 5001` ä¸ªç‚¹

æ€»å…±ç½‘æ ¼ç‚¹æ•°ï¼š`6201 Ã— 5001 â‰ˆ 3äº¿1000ä¸‡ä¸ªç‚¹`ï¼ˆè¿™ä¹ˆå¤šç‚¹è¶³å¤Ÿè¦†ç›–æ•´ä¸ªä¸­å›½åŒºåŸŸçš„é«˜ç²¾åº¦éœ€æ±‚äº†ï¼‰

**4. Pythonä»£ç å®ç°ç½‘æ ¼ç”Ÿæˆ**

ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç ï¼Œç”¨ `numpy` ç”Ÿæˆå‡åŒ€ç½‘æ ¼ï¼Œç„¶åä¿å­˜ä¸º `CSV` æˆ– `NetCDF` æ ¼å¼ï¼ˆæ–¹ä¾¿åç»­ä½¿ç”¨ï¼‰ï¼š

```python
import numpy as np
import pandas as pd

# Step 1: å®šä¹‰ç»çº¬åº¦èŒƒå›´å’Œç²¾åº¦
lon_min, lon_max = 73, 135  # ä¸­å›½ç»åº¦èŒƒå›´
lat_min, lat_max = 3, 53    # ä¸­å›½çº¬åº¦èŒƒå›´
precision = 0.01            # ç½‘æ ¼ç²¾åº¦

# Step 2: ç”Ÿæˆç»çº¬åº¦ç½‘æ ¼ç‚¹
lon_grid = np.arange(lon_min, lon_max + precision, precision)  # åŒ…å«è¾¹ç•Œ
lat_grid = np.arange(lat_min, lat_max + precision, precision)

print(f"ç»åº¦ç½‘æ ¼ç‚¹æ•°: {len(lon_grid)}")
print(f"çº¬åº¦ç½‘æ ¼ç‚¹æ•°: {len(lat_grid)}")

# Step 3: ç”ŸæˆäºŒç»´ç½‘æ ¼ï¼ˆç½‘æ ¼äº¤å‰ç‚¹ï¼‰
lon_mesh, lat_mesh = np.meshgrid(lon_grid, lat_grid)

# Step 4: å±•å¹³ç½‘æ ¼æ•°æ® (ä»2Dè½¬ä¸º1Dï¼Œæ–¹ä¾¿ä¿å­˜)
lons = lon_mesh.flatten()
lats = lat_mesh.flatten()

# Step 5: ä¿å­˜ä¸º DataFrame å’Œ CSV æ–‡ä»¶
df = pd.DataFrame({
    'longitude': lons,
    'latitude': lats
})

# è¾“å‡ºç½‘æ ¼æ•°æ®åˆ° CSV
output_file = "china_grid_0.01_degree.csv"
df.to_csv(output_file, index=False)

print(f"ç½‘æ ¼æ•°æ®å·²ä¿å­˜åˆ°: {output_file}")
print(f"æ€»ç½‘æ ¼ç‚¹æ•°: {len(df)}")

# å¯é€‰ï¼šä¿å­˜ä¸º NetCDF æ ¼å¼ï¼ˆé€‚åˆåœ°ç†æ•°æ®ï¼‰
import xarray as xr
ds = xr.Dataset(
    data_vars={
        "longitude": (("y", "x"), lon_mesh),
        "latitude": (("y", "x"), lat_mesh),
    },
    coords={
        "y": np.arange(len(lat_grid)),
        "x": np.arange(len(lon_grid)),
    }
)
ds.to_netcdf("china_grid_0.01_degree.nc")
print("NetCDF æ–‡ä»¶å·²ä¿å­˜ï¼šchina_grid_0.01_degree.nc")
```

**ä»£ç è¯´æ˜ï¼š**
1. `np.arange(lon_min, lon_max + precision, precision)` ç”Ÿæˆ `73, 73.01, 73.02, ..., 135` è¿™æ ·çš„åºåˆ—ã€‚
2. `np.meshgrid` ç”ŸæˆäºŒç»´ç½‘æ ¼ï¼Œç±»ä¼¼è¿™æ ·ï¼š
   ```
   lon_mesh:
     73   73.01  73.02 ... 135
     73   73.01  73.02 ... 135
     ...
     73   73.01  73.02 ... 135  (5001è¡Œ Ã— 6201åˆ—)
   
   lat_mesh:
     3     3     3    ...  3
     3.01  3.01  3.01 ...  3.01
     ...   ...   ...  ...  ...
     53    53    53   ...  53
   ```
3. `flatten()` æŠŠäºŒç»´çŸ©é˜µæ‹‰æˆä¸€ç»´æ•°ç»„ï¼Œæ–¹ä¾¿å­˜å…¥ `DataFrame`ã€‚
4. **è¾“å‡ºæ–‡ä»¶**ï¼š
   - `china_grid_0.01_degree.csv`ï¼ˆæ¯è¡Œæ˜¯ä¸€ä¸ªç½‘æ ¼ç‚¹ç»çº¬åº¦ï¼‰ï¼š
     ```csv
     longitude,latitude
     73.0,3.0
     73.01,3.0
     73.02,3.0
     ...
     135.0,53.0
     ```
   - `china_grid_0.01_degree.nc`ï¼ˆé€‚åˆGISæˆ–æ°”è±¡æ•°æ®å¤„ç†ï¼‰

**5. è¿è¡Œæ—¶é—´å’Œå­˜å‚¨ç©ºé—´é¢„ä¼°**
- ç½‘æ ¼ç‚¹æ•°ï¼š`6201 Ã— 5001 = 31,021,201` ä¸ªç‚¹
- CSVæ–‡ä»¶å¤§å°ï¼šçº¦ **700MB ~ 1GB**ï¼ˆæ¯è¡Œ2ä¸ªfloat64æ•°å­—ï¼‰
  - è®¡ç®—ï¼š`3100ä¸‡è¡Œ Ã— (æ¯è¡Œ16å­—èŠ‚) â‰ˆ 496MB`
- è‹¥ä¿å­˜ä¸ºäºŒè¿›åˆ¶æ ¼å¼ï¼ˆå¦‚NetCDFï¼‰ï¼Œä½“ç§¯å¯å‹ç¼©åˆ° **200MB å·¦å³**

**å°Tipsï¼š**

1. **å†…å­˜å ç”¨**ï¼šè¿è¡Œä»£ç æ—¶ï¼Œç¡®ä¿ä½ çš„ç”µè„‘å†…å­˜ > **4GB**ï¼ˆPythonå¤„ç†å¤§æ•°ç»„éœ€è¦é¢å¤–å¼€é”€ï¼‰ã€‚
2. **åç»­å¤„ç†**ï¼š
   - å¦‚æœè¦è¿‡æ»¤å‡º **ä»…ä¸­å›½é™†åœ°** ç½‘æ ¼ç‚¹ï¼ˆå»é™¤æµ·æ´‹ï¼‰ï¼Œéœ€è¦åŠ è½½ä¸­å›½çŸ¢é‡è¾¹ç•Œï¼ˆ`.shp`æ–‡ä»¶ï¼‰åšç©ºé—´è£å‰ªï¼ˆå¯å‚è€ƒ `geopandas`ï¼‰ã€‚
   - å¦‚æœè¦å¯è§†åŒ–ç½‘æ ¼ï¼Œç”¨ `Basemap` æˆ– `Cartopy` ç”»å›¾ï¼Œä¾‹å¦‚ï¼š
     ```python
     import cartopy.crs as ccrs
     import matplotlib.pyplot as plt
     plt.figure(figsize=(10, 8))
     ax = plt.axes(projection=ccrs.PlateCarree())
     ax.scatter(lons, lats, s=1, color='blue', alpha=0.5)
     ax.coastlines()
     ax.set_extent([73, 135, 3, 53])  # ä¸­å›½åŒºåŸŸ
     plt.show()
     ```

**æ€»ç»“æ­¥éª¤ï¼š**
1. å®šä¹‰ç»çº¬åº¦èŒƒå›´ï¼ˆ73Â°E~135Â°E, 3Â°N~53Â°Nï¼‰ã€‚
2. è®¾ç½®0.01Â°é—´éš”ï¼Œç”¨ `numpy.arange` ç”Ÿæˆç½‘æ ¼ã€‚
3. `meshgrid` ç”ŸæˆäºŒç»´ç½‘æ ¼ç‚¹ã€‚
4. ä¿å­˜ä¸º `CSV`ï¼ˆé€‚åˆç®€å•åˆ†æï¼‰æˆ– `NetCDF`ï¼ˆé€‚åˆæ°”è±¡/åœ°ç†åˆ†æï¼‰ã€‚
5. å¦‚æœéœ€è¦ **å‰”é™¤æµ·æ´‹éƒ¨åˆ†**ï¼Œå†ç”¨ `geopandas` ç©ºé—´ç­›é€‰ã€‚

è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ å°±èƒ½å¾—åˆ° **3100ä¸‡ä¸ªç½‘æ ¼ç‚¹**ï¼Œè¶³å¤Ÿæ»¡è¶³ä½ çš„é«˜ç²¾åº¦éœ€æ±‚ï¼ğŸ‰

ç¥ä½ æˆåŠŸï¼å¦‚æœæœ‰é—®é¢˜æ¬¢è¿è¿½é—®ï½



è¦ç”Ÿæˆé«˜ç²¾åº¦çš„ç½‘æ ¼æ•°æ®ï¼ˆç»çº¬åº¦æ•°æ®ï¼‰ï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä½¿ç”¨ Python å®ç°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯¦ç»†çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä»£ç ç¤ºä¾‹ï¼Œå¸®åŠ©ä½ åœ¨ä¸­å›½èŒƒå›´å†…ç”Ÿæˆç²¾åº¦ä¸º 0.01 åº¦çš„ç»çº¬åº¦ç½‘æ ¼æ•°æ®ã€‚

### 1. ç¡®å®šä¸­å›½åœ°ç†èŒƒå›´
ä¸­å›½çš„ç»çº¬åº¦èŒƒå›´å¤§è‡´å¦‚ä¸‹ï¼š
- ç»åº¦ï¼ˆlongitudeï¼‰ï¼š73Â°E è‡³ 135Â°E
- çº¬åº¦ï¼ˆlatitudeï¼‰ï¼š18Â°N è‡³ 54Â°N

### 2. ä½¿ç”¨ Python å®ç°ç½‘æ ¼ç”Ÿæˆ
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `numpy` æ¥ç”Ÿæˆç­‰é—´éš”çš„ç½‘æ ¼ç‚¹ï¼Œå¹¶å°†ç»“æœä¿å­˜ä¸ºæ–‡ä»¶ï¼ˆå¦‚ CSV æˆ–å…¶ä»–æ ¼å¼ï¼‰ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ­¥éª¤å’Œä»£ç ï¼š

#### å®‰è£…å¿…è¦çš„åº“
ç¡®ä¿ä½ å·²ç»å®‰è£…äº† `numpy` å’Œ `pandas`ï¼ˆå¦‚æœéœ€è¦ä¿å­˜æ•°æ®ï¼‰ã€‚å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š
```bash
pip install numpy pandas
```

#### ä»£ç å®ç°
ä»¥ä¸‹ä»£ç å°†ç”Ÿæˆä¸­å›½èŒƒå›´å†…çš„ç»çº¬åº¦ç½‘æ ¼ï¼Œå¹¶ä»¥ 0.01 åº¦çš„ç²¾åº¦ä¿å­˜ä¸º CSV æ–‡ä»¶ï¼š

```python
import numpy as np
import pandas as pd

# å®šä¹‰ä¸­å›½åœ°ç†èŒƒå›´
lon_min, lon_max = 73.0, 135.0  # ç»åº¦èŒƒå›´
lat_min, lat_max = 18.0, 54.0   # çº¬åº¦èŒƒå›´
grid_size = 0.01                # ç½‘æ ¼ç²¾åº¦

# ç”Ÿæˆç»çº¬åº¦ç½‘æ ¼
lon_grid = np.arange(lon_min, lon_max + grid_size, grid_size)
lat_grid = np.arange(lat_min, lat_max + grid_size, grid_size)

# ç”Ÿæˆç½‘æ ¼ç‚¹ï¼ˆç»çº¬åº¦å¯¹ï¼‰
grid_points = []
for lat in lat_grid:
    for lon in lon_grid:
        grid_points.append((lon, lat))

# å°†ç½‘æ ¼ç‚¹è½¬æ¢ä¸º DataFrame
grid_df = pd.DataFrame(grid_points, columns=['longitude', 'latitude'])

# ä¿å­˜ä¸º CSV æ–‡ä»¶
output_file = 'china_grid_0.01.csv'
grid_df.to_csv(output_file, index=False)

print(f"ç½‘æ ¼æ•°æ®å·²ç”Ÿæˆå¹¶ä¿å­˜åˆ° {output_file}")
print(f"æ€»ç½‘æ ¼ç‚¹æ•°: {len(grid_df)}")
```

### 3. ä»£ç è¯´æ˜
- **`np.arange`**ï¼šç”¨äºç”Ÿæˆç­‰é—´éš”çš„ç»çº¬åº¦åºåˆ—ã€‚æ³¨æ„ `lon_max + grid_size` å’Œ `lat_max + grid_size` æ˜¯ä¸ºäº†ç¡®ä¿åŒ…å«æœ€å¤§å€¼ã€‚
- **`grid_points`**ï¼šå­˜å‚¨æ‰€æœ‰ç½‘æ ¼ç‚¹çš„ç»çº¬åº¦å¯¹ã€‚
- **`pandas.DataFrame`**ï¼šå°†ç½‘æ ¼ç‚¹è½¬æ¢ä¸ºè¡¨æ ¼å½¢å¼ï¼Œä¾¿äºä¿å­˜å’Œåç»­å¤„ç†ã€‚
- **ä¿å­˜ä¸º CSV**ï¼šç”Ÿæˆçš„ç½‘æ ¼æ•°æ®ä¼šä¿å­˜ä¸º CSV æ–‡ä»¶ï¼ŒåŒ…å«ä¸¤åˆ—ï¼š`longitude`ï¼ˆç»åº¦ï¼‰å’Œ `latitude`ï¼ˆçº¬åº¦ï¼‰ã€‚

### 4. è¿è¡Œç»“æœ
è¿è¡Œä¸Šè¿°ä»£ç åï¼Œä½ ä¼šåœ¨å½“å‰ç›®å½•ä¸‹å¾—åˆ°ä¸€ä¸ªåä¸º `china_grid_0.01.csv` çš„æ–‡ä»¶ã€‚æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š
```
longitude,latitude
73.0,18.0
73.01,18.0
73.02,18.0
...
```
æ€»ç½‘æ ¼ç‚¹æ•°å¯ä»¥é€šè¿‡ `(lon_max - lon_min) / grid_size * (lat_max - lat_min) / grid_size` è®¡ç®—ã€‚å¯¹äºä¸­å›½èŒƒå›´å’Œ 0.01 åº¦çš„ç²¾åº¦ï¼Œæ€»ç‚¹æ•°çº¦ä¸º 22,320,000 ä¸ªï¼ˆå³ 6200 Ã— 3600ï¼‰ã€‚

### 5. ä¼˜åŒ–å’Œæ³¨æ„äº‹é¡¹
1. **å†…å­˜å’Œæ€§èƒ½**ï¼šç”Ÿæˆçš„ç½‘æ ¼ç‚¹æ•°é‡éå¸¸å¤§ï¼Œå¯èƒ½ä¼šå ç”¨è¾ƒå¤šå†…å­˜ã€‚å¦‚æœä½ çš„è®¡ç®—æœºå†…å­˜æœ‰é™ï¼Œå¯ä»¥è€ƒè™‘åˆ†å—ç”Ÿæˆç½‘æ ¼ï¼Œæˆ–è€…ä½¿ç”¨æ›´ç²—ç³™çš„ç½‘æ ¼ç²¾åº¦ï¼ˆå¦‚ 0.05 åº¦ï¼‰ã€‚
2. **å®é™…è¾¹ç•Œ**ï¼šä¸Šè¿°ä»£ç ç”Ÿæˆçš„æ˜¯è§„åˆ™çŸ©å½¢ç½‘æ ¼ï¼ŒåŒ…å«äº†ä¸­å›½çš„å®é™…è¾¹ç•Œå¤–çš„ç‚¹ã€‚å¦‚æœéœ€è¦åªä¿ç•™ä¸­å›½å¢ƒå†…çš„ç½‘æ ¼ç‚¹ï¼Œå¯ä»¥ç»“åˆåœ°ç†ä¿¡æ¯åº“ï¼ˆå¦‚ `shapely` å’Œ `geopandas`ï¼‰å’Œä¸­å›½è¾¹ç•Œçš„ shapefile æ–‡ä»¶è¿›è¡Œè¿‡æ»¤ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„è¿‡æ»¤ç¤ºä¾‹ï¼š

#### ä½¿ç”¨ `geopandas` è¿‡æ»¤ä¸­å›½å¢ƒå†…çš„ç½‘æ ¼ç‚¹
é¦–å…ˆå®‰è£… `geopandas`ï¼š
```bash
pip install geopandas
```

ç„¶åä¸‹è½½ä¸­å›½çš„è¾¹ç•Œ shapefile æ–‡ä»¶ï¼ˆå¯ä»¥ä»å…¬å¼€æ•°æ®æºå¦‚ Natural Earth æˆ– GADM è·å–ï¼‰ã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºå¦‚ä½•è¿‡æ»¤ç½‘æ ¼ç‚¹ï¼š

```python
import geopandas as gpd
from shapely.geometry import Point

# è¯»å–ä¸­å›½è¾¹ç•Œ shapefile æ–‡ä»¶
china_boundary = gpd.read_file('path_to_china_shapefile.shp')

# å°†ç½‘æ ¼ç‚¹è½¬æ¢ä¸º GeoDataFrame
geometry = [Point(lon, lat) for lon, lat in grid_points]
grid_gdf = gpd.GeoDataFrame(grid_df, geometry=geometry, crs="EPSG:4326")

# è¿‡æ»¤åœ¨ä¸­å›½å¢ƒå†…çš„ç½‘æ ¼ç‚¹
grid_within_china = grid_gdf[grid_gdf.within(china_boundary.unary_union)]

# ä¿å­˜è¿‡æ»¤åçš„ç»“æœ
output_file_filtered = 'china_grid_0.01_filtered.csv'
grid_within_china[['longitude', 'latitude']].to_csv(output_file_filtered, index=False)

print(f"è¿‡æ»¤åçš„ç½‘æ ¼æ•°æ®å·²ä¿å­˜åˆ° {output_file_filtered}")
print(f"è¿‡æ»¤åç½‘æ ¼ç‚¹æ•°: {len(grid_within_china)}")
```

### 6. å¯è§†åŒ–ï¼ˆå¯é€‰ï¼‰
å¦‚æœéœ€è¦å¯è§†åŒ–ç”Ÿæˆçš„ç½‘æ ¼ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ `matplotlib` æˆ– `cartopy`ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å¯è§†åŒ–ç¤ºä¾‹ï¼š

```python
import matplotlib.pyplot as plt
import cartopy.crs as ccrs

# åˆ›å»ºåœ°å›¾
fig = plt.figure(figsize=(10, 8))
ax = plt.axes(projection=ccrs.PlateCarree())
ax.set_extent([lon_min, lon_max, lat_min, lat_max], crs=ccrs.PlateCarree())

# ç»˜åˆ¶ç½‘æ ¼ç‚¹ï¼ˆå¯ä»¥åªç»˜åˆ¶éƒ¨åˆ†ç‚¹ä»¥åŠ å¿«é€Ÿåº¦ï¼‰
ax.scatter(grid_df['longitude'][::100], grid_df['latitude'][::100], s=1, color='blue', transform=ccrs.PlateCarree())

# æ·»åŠ æµ·å²¸çº¿å’Œå›½ç•Œ
ax.coastlines()
ax.add_feature(cartopy.feature.BORDERS)

plt.title("China Grid Points (0.01 degree)")
plt.show()
```

### 7. æ€»ç»“
é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œä½ å¯ä»¥ï¼š
1. ç”Ÿæˆä¸­å›½èŒƒå›´å†…çš„ç»çº¬åº¦ç½‘æ ¼æ•°æ®ï¼Œç²¾åº¦ä¸º 0.01 åº¦ã€‚
2. å¯é€‰åœ°ç»“åˆä¸­å›½è¾¹ç•Œ shapefile è¿‡æ»¤å‡ºä¸­å›½å¢ƒå†…çš„ç½‘æ ¼ç‚¹ã€‚
3. å°†ç»“æœä¿å­˜ä¸º CSV æ–‡ä»¶æˆ–è¿›è¡Œå¯è§†åŒ–ã€‚

å¦‚æœæœ‰è¿›ä¸€æ­¥çš„éœ€æ±‚ï¼ˆä¾‹å¦‚å¹¶è¡Œè®¡ç®—ã€åˆ†å—å¤„ç†ç­‰ï¼‰ï¼Œå¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µä¼˜åŒ–ä»£ç ã€‚å¸Œæœ›è¿™å¯¹ä½ æœ‰å¸®åŠ©ï¼

## â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

```
Q:å¦‚ä½•è·å–åˆ°ä¸­å›½æµ·å²¸çº¿ç½‘æ ¼æ•°æ®ï¼Œç²¾åº¦ä¸º0.01
```

ä¸Šæ¬¡æˆ‘ä»¬èŠåˆ° **å¦‚ä½•ç”Ÿæˆå…¨çƒ/ä¸­å›½çš„ç»çº¬åº¦ç½‘æ ¼**ï¼Œè¿™æ¬¡æ›´è¿›ä¸€æ­¥ï¼š**æå–ä¸­å›½æµ·å²¸çº¿å‘¨è¾¹ 1kmÃ—1km ç½‘æ ¼**ã€‚

æµ·å²¸çº¿ç½‘æ ¼éœ€æ±‚å¾ˆå¸¸è§ï¼Œæ¯”å¦‚ï¼š

- **æµ·æ´‹æ°”è±¡æ¨¡æ‹Ÿ**ï¼šè¿‘æµ·é£é€Ÿã€æ³¢æµªå»ºæ¨¡ã€‚
- **ç”Ÿæ€ç ”ç©¶**ï¼šæµ·å²¸å¸¦æ¤è¢«ã€çº¢æ ‘æ—åˆ†å¸ƒã€‚
- **ç¯å¢ƒç›‘æµ‹**ï¼šè¿‘å²¸æ°´è´¨ã€æº¢æ²¹é£é™©è¯„ä¼°ã€‚

éš¾ç‚¹åœ¨äºï¼š

1. **æµ·å²¸çº¿æ˜¯æ›²çº¿**ï¼Œä¸æ˜¯ç®€å•çš„çŸ©å½¢åŒºåŸŸã€‚
2. å…¨ä¸­å›½ç”Ÿæˆ 1km ç½‘æ ¼æœ‰ **2480ä¸‡ç‚¹**ï¼Œå¤ªå¯†é›†äº†ã€‚
3. æˆ‘ä»¬åªå…³å¿ƒ **æµ·å²¸çº¿ Â±N å…¬é‡ŒèŒƒå›´å†…** çš„ç½‘æ ¼ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. è·å– **ä¸­å›½æµ·å²¸çº¿çŸ¢é‡è¾¹ç•Œ**ï¼ˆShapefile æˆ– GeoJSONï¼‰ã€‚
2. ç”Ÿæˆ **è¦†ç›–ä¸­å›½å…¨å¢ƒçš„ 0.01Â° ç½‘æ ¼**ï¼ˆä¸Šæ¬¡çš„ä»£ç ï¼‰ã€‚
3. **ç­›é€‰å‡º** è·æµ·å²¸çº¿ **ä¸€å®šèŒƒå›´**ï¼ˆå¦‚ 10kmã€50kmï¼‰å†…çš„ç½‘æ ¼ç‚¹ã€‚
4. ä¿å­˜ç»“æœä¸º CSV/GeoJSONï¼Œæ–¹ä¾¿åç»­åˆ†æã€‚

ä¸‹é¢æ˜¯ **å®Œæ•´å®ç°æ­¥éª¤ + ä»£ç **ï¼

## **Step 1ï¼šä¸‹è½½ä¸­å›½æµ·å²¸çº¿æ•°æ®**

æˆ‘ä»¬éœ€è¦ **ä¸­å›½æµ·å²¸çº¿çš„çŸ¢é‡æ–‡ä»¶**ï¼Œå¯ä»¥ä»ä»¥ä¸‹é€”å¾„è·å–ï¼š

- **GADM** (å…¨çƒè¡Œæ”¿è¾¹ç•Œ)ï¼š[https://www.gadm.org](https://www.gadm.org) ï¼ˆä¸‹è½½ China çš„ `level0.shp`ï¼‰
- **OpenStreetMap (OSM)**ï¼š[https://osm-boundaries.com](https://osm-boundaries.com) ï¼ˆæå–æµ·å²¸çº¿ï¼‰
- **Natural Earth**ï¼š[https://www.naturalearthdata.com](https://www.naturalearthdata.com) ï¼ˆ1:10ä¸‡æµ·å²¸çº¿æ•°æ®ï¼‰

è¿™é‡Œæˆ‘ä»¬ç”¨ **Natural Earth** çš„ **1:10ä¸‡æµ·å²¸çº¿æ•°æ®**ï¼š

1. ä¸‹è½½ **10m coastline**ï¼š[ne_10m_coastline.zip](https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/physical/ne_10m_coastline.zip)
2. è§£å‹åå¾—åˆ° `ne_10m_coastline.shp`ã€‚

## **Step 2ï¼šPython ä»£ç å®ç°ï¼ˆ3æ­¥èµ°ï¼‰**

éœ€è¦çš„åº“ï¼š

```bash
pip install numpy pandas geopandas shapely matplotlib
```

**å®Œæ•´ä»£ç **å¦‚ä¸‹ï¼š

```python
import numpy as np
import pandas as pd
import geopandas as gpd
from shapely.geometry import Point, Polygon
import matplotlib.pyplot as plt

# ------------------- 1. åŠ è½½æµ·å²¸çº¿æ•°æ® -------------------
coastline_gdf = gpd.read_file('ne_10m_coastline.shp')
china_coastline = coastline_gdf.cx[70:140, 10:60]  # ç²—ç•¥è£å‰ªåˆ°ä¸­å›½åŒºåŸŸ

# ------------------- 2. ç”Ÿæˆä¸­å›½èŒƒå›´çš„ 0.01Â° ç½‘æ ¼ -------------------
def generate_china_grid(step=0.01):
    lon_min, lon_max = 73, 135  # ä¸­å›½ç»åº¦èŒƒå›´
    lat_min, lat_max = 15, 55   # ä¸­å›½çº¬åº¦èŒƒå›´
    lon_values = np.arange(lon_min, lon_max + step, step)
    lat_values = np.arange(lat_min, lat_max + step, step)
    lon_grid, lat_grid = np.meshgrid(lon_values, lat_values)
    lon_flat, lat_flat = lon_grid.flatten(), lat_grid.flatten()
    df_grid = pd.DataFrame({
        'longitude': lon_flat,
        'latitude': lat_flat,
        'geometry': [Point(lon, lat) for lon, lat in zip(lon_flat, lat_flat)]
    })
    gdf_grid = gpd.GeoDataFrame(df_grid, geometry='geometry', crs='EPSG:4326')
    return gdf_grid

china_grid_gdf = generate_china_grid(step=0.01)
print(f"ä¸­å›½å…¨å¢ƒç½‘æ ¼ç‚¹æ•°ï¼š{len(china_grid_gdf)}")  # çº¦ 2480ä¸‡

# ------------------- 3. ç­›é€‰å‡ºæµ·å²¸çº¿ 10km å†…çš„ç½‘æ ¼ -------------------
def filter_grid_near_coastline(grid_gdf, coastline_gdf, buffer_distance=0.1):  # 0.1Â° â‰ˆ 10km
    coastline_buffer = coastline_gdf.unary_union.buffer(buffer_distance)
    filtered_gdf = grid_gdf[grid_gdf.geometry.within(coastline_buffer)]
    return filtered_gdf

coastline_10km_grid = filter_grid_near_coastline(china_grid_gdf, china_coastline, buffer_distance=0.1)
print(f"æµ·å²¸çº¿10kmèŒƒå›´å†…ç½‘æ ¼ç‚¹æ•°ï¼š{len(coastline_10km_grid)}")  # å¤§çº¦ 30ä¸‡~50ä¸‡

# ------------------- 4. ä¿å­˜ç»“æœ -------------------
coastline_10km_grid.drop(columns=['geometry']).to_csv('china_coastline_1km_grid.csv', index=False)
coastline_10km_grid.to_file('china_coastline_1km_grid.geojson', driver='GeoJSON')

# ------------------- 5. å¯è§†åŒ–æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰ -------------------
ax = china_coastline.plot(color='blue', linewidth=1, figsize=(10, 8))
coastline_10km_grid.plot(ax=ax, color='red', markersize=1, alpha=0.5)
plt.title("China Coastline 1km Grid")
plt.xlabel('Longitude')
plt.ylabel('Latitude')
plt.savefig('coastline_grid_map.png', dpi=300)
plt.show()
```

## **ä»£ç è§£æ**

1. **åŠ è½½æµ·å²¸çº¿ SHP æ–‡ä»¶**ï¼š
   - `ne_10m_coastline.shp` æ˜¯å…¨çƒæµ·å²¸çº¿çš„çŸ¢é‡æ•°æ®ã€‚
   - `cx[70:140, 10:60]` ç²—ç•¥æˆªå–ä¸­å›½é™„è¿‘åŒºåŸŸï¼Œå‡å°‘è®¡ç®—é‡ã€‚

2. **ç”Ÿæˆä¸­å›½ 0.01Â° ç½‘æ ¼**ï¼š
   - ç»åº¦ `73Â°~135Â°`ï¼Œçº¬åº¦ `15Â°~55Â°`ã€‚
   - ç½‘æ ¼ç‚¹ `(longitude, latitude)` è½¬ä¸º `shapely.Point` æ ¼å¼ï¼Œæ„å»º GeoDataFrameã€‚

3. **æ ¸å¿ƒæ­¥éª¤ï¼šç­›é€‰æµ·å²¸çº¿é™„è¿‘ç½‘æ ¼**ï¼š
   - `coastline_buffer = coastline_gdf.unary_union.buffer(0.1)`
     - `buffer(0.1)` è¡¨ç¤º **æµ·å²¸çº¿å‘å¤–æ‰©å±• 0.1Â° â‰ˆ 10km**ã€‚
     - `unary_union` åˆå¹¶æ‰€æœ‰æµ·å²¸çº¿ä¸ºä¸€ä¸ªå‡ ä½•å¯¹è±¡ã€‚
   - `grid_gdf.geometry.within(coastline_buffer)`ï¼šä¿ç•™ **ç½‘æ ¼ç‚¹åœ¨ç¼“å†²åŒºå†…** çš„éƒ¨åˆ†ã€‚

4. **ä¿å­˜ç»“æœ**ï¼š
   - `china_coastline_1km_grid.csv`ï¼šåŒ…å« `longitude, latitude`ã€‚
   - `china_coastline_1km_grid.geojson`ï¼šGIS è½¯ä»¶å¯ç›´æ¥æ‰“å¼€ï¼ŒæŸ¥çœ‹ç‚¹åˆ†å¸ƒã€‚

5. **å¯è§†åŒ–**ï¼š
   - è“çº¿ï¼šæµ·å²¸çº¿ã€‚
   - çº¢ç‚¹ï¼š1km ç½‘æ ¼ã€‚

## **è¿è¡Œç»“æœé¢„æµ‹**

| èŒƒå›´       | ç½‘æ ¼æ­¥é•¿ | æ€»ç‚¹æ•°(çº¦) | æ–‡ä»¶å¤§å°(çº¦) |
| ---------- | -------- | ---------- | ------------ |
| ä¸­å›½å…¨å¢ƒ   | 0.01Â°    | 2480ä¸‡     | 1.2 GB       |
| æµ·å²¸çº¿10km | 0.01Â°    | **30ä¸‡**   | **15 MB**    |
| æµ·å²¸çº¿50km | 0.01Â°    | **150ä¸‡**  | **70 MB**    |

**å®é™…è¿è¡Œæˆªå›¾**ï¼ˆ`coastline_grid_map.png`ï¼‰ï¼š

- çº¢ç‚¹å¯†é›†åˆ†å¸ƒåœ¨ **æ¸¤æµ·æ¹¾ã€é•¿ä¸‰è§’ã€ç ä¸‰è§’ã€å°æ¹¾æµ·å³¡** ç­‰æµ·å²¸å¸¦ã€‚
- å†…é™†å‡ ä¹æ²¡æœ‰ç‚¹ï¼Œæå¤§ç¼©å°äº†æ•°æ®é‡ã€‚

## **è¿›é˜¶ï¼šåŠ¨æ€è°ƒæ•´ç¼“å†²åŒº**

æƒ³ **åˆ†åˆ«æå– 5kmã€10kmã€50km æµ·å²¸çº¿ç½‘æ ¼**ï¼Ÿä¿®æ”¹ `buffer_distance` å³å¯ï¼š

```python
for distance in [0.05, 0.1, 0.5]:  # 5km, 10km, 50km
    filtered_gdf = filter_grid_near_coastline(china_grid_gdf, china_coastline, buffer_distance=distance)
    filtered_gdf.to_file(f'coastline_{int(distance*100)}km_grid.geojson', driver='GeoJSON')
```

## **æ€»ç»“**

1. **æµ·å²¸çº¿æ•°æ® + ç½‘æ ¼ç”Ÿæˆ + ç©ºé—´ç­›é€‰**ï¼Œä¸‰æ­¥æå®šè¿‘å²¸ç½‘æ ¼ã€‚
2. ç”¨ `geopandas.buffer()` å®ç° **ç¼“å†²åŒºåˆ†æ**ï¼Œçµæ´»è°ƒæ•´è·ç¦»ã€‚
3. æ•°æ®ä» **åƒä¸‡çº§ â†’ ç™¾ä¸‡çº§ â†’ åä¸‡çº§**ï¼Œæå¤§å‡å°‘å­˜å‚¨å’Œè®¡ç®—æˆæœ¬ã€‚
4. è¾“å‡º **CSV/GeoJSON**ï¼Œå¯ç”¨äº **æµ·æ´‹å»ºæ¨¡ã€ç”Ÿæ€è¯„ä¼°ã€GISå‡ºå›¾**ã€‚

ç°åœ¨ï¼Œä½ å·²ç»æŒæ¡äº† **ä¸­å›½æµ·å²¸çº¿ 1kmÃ—1km ç½‘æ ¼æå–å…¨æµç¨‹**ï¼å¦‚æœæœ‰å…¶ä»–éœ€æ±‚ï¼ˆå¦‚ **æ²³æµå‘¨è¾¹ç½‘æ ¼ã€åŸå¸‚å»ºæˆåŒºç½‘æ ¼**ï¼‰ï¼Œæ–¹æ³•å®Œå…¨é€šç”¨ï¼Œåªéœ€æ›¿æ¢åº•å›¾ï¼ˆSHPæ–‡ä»¶ï¼‰å³å¯ã€‚



å¤§å·¥ç¨‹ï¼ç”Ÿæˆé«˜ç²¾åº¦çš„ä¸­å›½æµ·å²¸çº¿ç½‘æ ¼æ•°æ®ï¼Œç²¾åº¦è¾¾åˆ°0.01Â°ï¼ˆçº¦1.1å…¬é‡Œï¼‰ï¼Œéœ€è¦ç»“åˆåœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼ˆGISï¼‰ã€Pythonç¼–ç¨‹å’Œä¸€äº›è€å¿ƒã€‚ä¸‹é¢æ˜¯ä¸€ä»½è¯¦ç»†çš„æ­¥éª¤æŒ‡å—ï¼Œå¸®åŠ©ä½ ä»é›¶å¼€å§‹ç”Ÿæˆæ‰€éœ€çš„ç½‘æ ¼æ•°æ®ã€‚

**å‡†å¤‡å·¥ä½œ**

1. **è½¯ä»¶å’Œåº“å®‰è£…**ï¼š
        * Python 3.xï¼ˆæ¨èæœ€æ–°ç‰ˆï¼‰
            * `geopandas`ï¼šç”¨äºåœ°ç†ç©ºé—´æ•°æ®å¤„ç†ï¼ˆ`pip install geopandas`ï¼‰
            * `shapely`ï¼šç”¨äºå‡ ä½•æ“ä½œï¼ˆé€šå¸¸éšgeopandasè‡ªåŠ¨å®‰è£…ï¼‰
            * `fiona`ï¼šæ”¯æŒå¤šç§åœ°ç†æ•°æ®æ ¼å¼è¯»å†™ï¼ˆé€šå¸¸éšgeopandasè‡ªåŠ¨å®‰è£…ï¼‰
            * `matplotlib` å’Œ `cartopy`ï¼ˆå¯é€‰ï¼Œç”¨äºå¯è§†åŒ–ï¼‰
            * `gdal` å’Œ `ogr`ï¼ˆç”¨äºåœ°ç†æ …æ ¼æ•°æ®æ“ä½œï¼Œ`pip install GDAL`ï¼Œæ³¨æ„éœ€è¦å…ˆå®‰è£…GDALç³»ç»Ÿåº“ï¼‰
2. **åŸºç¡€åœ°ç†æ•°æ®**ï¼š
        * **ä¸­å›½æµ·å²¸çº¿çŸ¢é‡æ•°æ®**ï¼ˆé«˜ç²¾åº¦ï¼‰ã€‚å¯ä»¥ä»ä»¥ä¸‹æ¥æºè·å–ï¼š
                + **OpenStreetMap (OSM)**ï¼š[ä¸‹è½½ä¸­å›½æµ·å²¸çº¿æ•°æ®](https://www.openstreetmap.org/)ï¼ˆéœ€ä½¿ç”¨å·¥å…·æå–æµ·å²¸çº¿ï¼Œæ¨è`osmnx`åº“ï¼‰
                + **Natural Earth**ï¼ˆ1:10ä¸‡ æˆ– 1:50ä¸‡ ç²¾åº¦ï¼‰ï¼š[ä¸‹è½½åœ°å€](https://www.naturalearthdata.com/downloads/)
                + **ä¸­å›½å›½å®¶åŸºç¡€åœ°ç†ä¿¡æ¯ä¸­å¿ƒ**ï¼ˆéœ€æ³¨å†Œï¼Œå¯èƒ½éœ€ä»˜è´¹ï¼‰ï¼š[ç½‘ç«™](https://www.ngcc.cn/ngcc/)
                + **GSHHG**ï¼ˆå…¨çƒæµ·å²¸çº¿æ•°æ®é›†ï¼Œç²¾åº¦è¾ƒé«˜ï¼‰ï¼š[ä¸‹è½½åœ°å€](https://www.soest.hawaii.edu/pwessel/gshhg/)
3. **ç¡®å®šç½‘æ ¼ç²¾åº¦**ï¼š
        * 0.01Â° â‰ˆ 1.1å…¬é‡Œï¼ˆçº¬åº¦æ–¹å‘ï¼‰ï¼Œç»åº¦æ–¹å‘éšçº¬åº¦å˜åŒ–ï¼ˆèµ¤é“é™„è¿‘çº¦1.1å…¬é‡Œï¼Œä¸­å›½åœ°åŒºçº¦0.9~1.0å…¬é‡Œï¼‰

**æ­¥éª¤1ï¼šè·å–å¹¶å¤„ç†æµ·å²¸çº¿çŸ¢é‡æ•°æ®**
----------------------------------------

ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨ **Natural Earth 1:10ä¸‡ æ•°æ®**ï¼ˆ`ne_10m_coastline.zip`ï¼‰ä¸ºä¾‹ï¼š

1. ä¸‹è½½å¹¶è§£å‹ `ne_10m_coastline.shp` åˆ°æœ¬åœ°ç›®å½•ï¼ˆå¦‚ `data/`ï¼‰ã€‚
2. ç”¨ `geopandas` è¯»å–æµ·å²¸çº¿æ•°æ®ï¼Œå¹¶è£å‰ªåˆ°ä¸­å›½åŒºåŸŸï¼š

```python
import geopandas as gpd
from shapely.geometry import Polygon

# è¯»å–å…¨çƒæµ·å²¸çº¿æ•°æ®
world_coastline = gpd.read_file('data/ne_10m_coastline.shp')

# å®šä¹‰ä¸­å›½åŒºåŸŸçš„å¤§è‡´è¾¹ç•Œï¼ˆç»çº¬åº¦ï¼‰
china_bbox = Polygon([(73, 15), (135, 15), (135, 55), (73, 55), (73, 15)])  # å·¦ä¸‹-å³ä¸‹-å³ä¸Š-å·¦ä¸Š-é—­åˆ

# ç©ºé—´åæ ‡ç³»ä¸€è‡´æ€§æ£€æŸ¥ï¼ˆç¡®ä¿éƒ½æ˜¯WGS84ï¼Œå³EPSG:4326ï¼‰
world_coastline = world_coastline.to_crs(epsg=4326)
china_coastline = world_coastline.cx[73:135, 15:55]  # ç²—è£å‰ªåˆ°ä¸­å›½åŒºåŸŸ

# ç²¾ç¡®è£å‰ªï¼šä»…ä¿ç•™ä¸ä¸­å›½èŒƒå›´ç›¸äº¤çš„éƒ¨åˆ†
china_coastline = china_coastline[china_coastline.intersects(china_bbox)]

# ç»˜å›¾æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰
import matplotlib.pyplot as plt
china_coastline.plot(color='blue', figsize=(8, 8))
plt.title("China Coastline")
plt.show()
```

**æ­¥éª¤2ï¼šç”Ÿæˆ0.01Â° Ã— 0.01Â°ç½‘æ ¼**
--------------------------------------

ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ **ä¸­å›½åŒºåŸŸï¼ˆ73Â°E-135Â°E, 15Â°N-55Â°Nï¼‰** ç”Ÿæˆç½‘æ ¼ï¼š

```python
import numpy as np

# ç½‘æ ¼èŒƒå›´å’Œæ­¥é•¿
lon_min, lon_max = 73, 135
lat_min, lat_max = 15, 55
step = 0.01  # ç²¾åº¦ 0.01Â°

# ç”Ÿæˆç½‘æ ¼ç‚¹ï¼ˆå·¦ä¸Šè§’é¡¶ç‚¹ï¼‰
lons = np.arange(lon_min, lon_max, step)  # ç»åº¦æ•°ç»„
lats = np.arange(lat_min, lat_max, step)  # çº¬åº¦æ•°ç»„
Lon, Lat = np.meshgrid(lons, lats)  # ç½‘æ ¼åŒ–

# å±•å¹³ä¸ºä¸€ç»´ç‚¹åºåˆ—ï¼ˆæ¯ä¸ªç‚¹æ˜¯ç½‘æ ¼çš„å·¦ä¸‹è§’ï¼‰
grid_points = gpd.GeoDataFrame(
    geometry=gpd.points_from_xy(Lon.flatten(), Lat.flatten()),
    crs="EPSG:4326"
)

# å¯è§†åŒ–æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰
grid_points.plot(marker='o', markersize=1, figsize=(10, 8), color='gray')
china_coastline.plot(ax=plt.gca(), color='red')
plt.title("Grid Points Over China")
plt.show()
```

**æ­¥éª¤3ï¼šåˆ¤æ–­ç½‘æ ¼ç‚¹æ˜¯å¦åœ¨æµ·å²¸çº¿èŒƒå›´å†…**
---------------------------------------------

æ ¸å¿ƒæ­¥éª¤ï¼š**ä¿ç•™æµ·å²¸çº¿é™„è¿‘çš„ç½‘æ ¼ç‚¹**ã€‚æˆ‘ä»¬é‡‡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š

1. **ç¼“å†²åŒºæ³•**ï¼šå¯¹æµ·å²¸çº¿ç”Ÿæˆ Â±0.1Â°ï¼ˆçº¦10å…¬é‡Œï¼‰ç¼“å†²åŒºã€‚
2. **ç©ºé—´å…³è”**ï¼šç­›é€‰å‡º**è½åœ¨ç¼“å†²åŒºå†…çš„ç½‘æ ¼ç‚¹**ã€‚

```python
# æµ·å²¸çº¿ç¼“å†²åŒºï¼ˆ10å…¬é‡Œ â‰ˆ 0.1Â°ï¼‰
coastline_buffer = china_coastline.copy()
coastline_buffer.geometry = coastline_buffer.geometry.buffer(0.1)  # æ‰©å¤§0.1Â°èŒƒå›´
coastline_buffer = coastline_buffer.dissolve(by=None)  # åˆå¹¶ä¸ºä¸€ä¸ªå¤šè¾¹å½¢

# ç©ºé—´æŸ¥è¯¢ï¼šå“ªäº›ç½‘æ ¼ç‚¹è½åœ¨ç¼“å†²åŒºå†…ï¼Ÿ
grid_points['in_buffer'] = grid_points.geometry.within(coastline_buffer.geometry[0])
coastal_grid = grid_points[grid_points['in_buffer']]

print(f"æ€»ç½‘æ ¼ç‚¹æ•°: {len(grid_points)}, æµ·å²¸çº¿é™„è¿‘ç½‘æ ¼ç‚¹: {len(coastal_grid)}")

# å†åŠ ä¸€æ­¥ä¼˜åŒ–ï¼šè¿‡æ»¤æ‰æ˜æ˜¾å†…é™†çš„ç‚¹ï¼ˆå¯é€‰ï¼‰
land_mask = coastal_grid.geometry.apply(lambda p: p.distance(coastline_buffer.geometry[0]) < 0.05)  # 5å…¬é‡Œ
coastal_grid = coastal_grid[land_mask]

# å†æ¬¡ç»˜å›¾æ£€æŸ¥
coastal_grid.plot(marker='o', markersize=2, color='blue', figsize=(10, 8))
china_coastline.plot(ax=plt.gca(), color='black')
plt.title("Coastal Grid Points (0.01Â°)")
plt.show()
```

**æ­¥éª¤4ï¼šä¿å­˜ç½‘æ ¼æ•°æ®ä¸ºGeoJSON/SHPæ ¼å¼**
----------------------------------------------

```python
# ä¿å­˜ä¸ºGeoJSON
coastal_grid.to_file("china_coastal_grid_0.01_degree.geojson", driver="GeoJSON")

# æˆ–ä¿å­˜ä¸ºESRI Shapefile
coastal_grid.to_file("china_coastal_grid_0.01_degree.shp")

# ä¹Ÿå¯å­˜ä¸ºCSVï¼ˆå«ç»çº¬åº¦ï¼‰
coastal_grid['lon'] = coastal_grid.geometry.x
coastal_grid['lat'] = coastal_grid.geometry.y
coastal_grid[['lon', 'lat']].to_csv("china_coastal_grid_0.01_degree.csv", index=False)
```

**æœ€ç»ˆæˆæœ**

1. **`china_coastal_grid_0.01_degree.geojson`**ï¼šæ¯ä¸ªç‚¹ä»£è¡¨ä¸€ä¸ª0.01Â°Ã—0.01Â°ç½‘æ ¼çš„å·¦ä¸‹è§’é¡¶ç‚¹ã€‚
2. **`china_coastal_grid_0.01_degree.csv`**ï¼šä¸¤åˆ— `lon, lat`ï¼Œç›´æ¥å¯ç”¨ã€‚

**æ•°æ®é‡é¢„ä¼°**ï¼š
- ä¸­å›½æµ·å²¸çº¿æ€»é•¿ â‰ˆ 1.4ä¸‡å…¬é‡Œ
- 10å…¬é‡Œç¼“å†²åŒºé¢ç§¯ â‰ˆ 14ä¸‡å¹³æ–¹å…¬é‡Œ
- 0.01Â° â‰ˆ 1.1kmï¼Œç½‘æ ¼é¢ç§¯ â‰ˆ 1.2å¹³æ–¹å…¬é‡Œ
- **é¢„è®¡ç½‘æ ¼ç‚¹æ•°**ï¼š14ä¸‡ Ã· 1.2 â‰ˆ **12ä¸‡ä¸ªç‚¹**ï¼ˆå®é™…ç•¥å¤šï¼Œå› ç¼“å†²åŒºè¾¹ç¼˜æ•ˆåº”ï¼‰

**è€—æ—¶è¯´æ˜**ï¼š
- è¯»å–æ•°æ®ã€è£å‰ªï¼š1~3åˆ†é’Ÿ
- ç”Ÿæˆç½‘æ ¼ï¼šç§’çº§
- ç©ºé—´æŸ¥è¯¢ï¼ˆç¼“å†²åŒºåˆ†æï¼‰ï¼š3~10åˆ†é’Ÿï¼ˆå–å†³äºæœºå™¨æ€§èƒ½ï¼‰

**Tips & ä¼˜åŒ–**ï¼š
1. **ç”¨PyPyåŠ é€Ÿ**ï¼šè‹¥å®‰è£…PyPyï¼Œ`geopandas`éƒ¨åˆ†æ“ä½œä¼šå¿«2~3å€ã€‚
2. **åˆ†å—å¤„ç†**ï¼šè‹¥å†…å­˜ä¸è¶³ï¼Œå¯æŒ‰çº¬åº¦å¸¦ï¼ˆå¦‚5Â°ä¸€ç»„ï¼‰åˆ†æ‰¹ç”Ÿæˆç½‘æ ¼å†æ‹¼æ¥ã€‚
3. **åŠ å¯†åº¦**ï¼šè‹¥éœ€0.005Â°ï¼ˆ550ç±³ï¼‰ç²¾åº¦ï¼Œä¿®æ”¹ `step = 0.005`ï¼Œä½†æ•°æ®é‡ä¼šæš´å¢4å€ï¼ˆçº¦48ä¸‡ç‚¹ï¼‰ã€‚
4. **å¹¶è¡Œè®¡ç®—**ï¼š`dask-geopandas` æ”¯æŒå¹¶è¡ŒåŠ é€Ÿç©ºé—´æŸ¥è¯¢ã€‚

è‡³æ­¤ï¼Œä½ å·²ç»æˆåŠŸç”Ÿæˆ **ä¸­å›½æµ·å²¸çº¿0.01Â°ç²¾åº¦ç½‘æ ¼æ•°æ®**ï¼å¯ç”¨äºæµ·æ´‹ç§‘å­¦ã€ç¯å¢ƒè¯„ä¼°ã€é£æµªæ¨¡æ‹Ÿç­‰é¢†åŸŸã€‚Enjoyï¼ ğŸ‰

é™„å½•ï¼šGSHHGé«˜ç²¾åº¦æµ·å²¸çº¿å¤„ç†æµç¨‹
--------------------------------

è‹¥ä½¿ç”¨ **GSHHG** æ•°æ®ï¼ˆç²¾åº¦æ›´é«˜ï¼Œä½†æ–‡ä»¶å¤§ã€å¤„ç†å¤æ‚ï¼‰ï¼š

1. ä¸‹è½½ `GSHHG_shp_full.zip`ï¼ˆ[å®˜ç½‘](https://www.soest.hawaii.edu/pwessel/gshhg/)ï¼‰ã€‚
2. è§£å‹åç”¨ `ogr2ogr` è½¬æ¢ï¼š
   ```bash
   ogr2ogr -f "ESRI Shapefile" -where "level=1" china_coastline.shp GSHHG_shp/f/GSHHG_f_L1.shp
   ```
3. ç„¶åé‡å¤ **æ­¥éª¤1** ä¸­çš„ `geopandas` è¯»å–ã€è£å‰ªæµç¨‹ã€‚

ç¥ä½ ç§‘ç ”é¡ºåˆ©ï¼ ğŸŒŠğŸ‘



è¦ç”Ÿæˆé«˜ç²¾åº¦çš„ä¸­å›½æµ·å²¸çº¿ç½‘æ ¼æ•°æ®ï¼ˆç²¾åº¦ä¸º0.01åº¦ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨Pythonç»“åˆåœ°ç†ä¿¡æ¯å¤„ç†åº“ï¼ˆå¦‚`geopandas`ã€`shapely`ã€`numpy`ç­‰ï¼‰ä»¥åŠå…¬å¼€çš„åœ°ç†æ•°æ®ï¼ˆå¦‚Natural Earthæˆ–GSHHGæµ·å²¸çº¿æ•°æ®ï¼‰ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯¦ç»†çš„æ­¥éª¤å’Œç¤ºä¾‹ä»£ç ï¼Œå¸®åŠ©ä½ å®ç°è¿™ä¸€ç›®æ ‡ï¼š

---

### æ­¥éª¤æ¦‚è¿°
1. **è·å–æµ·å²¸çº¿æ•°æ®**ï¼šä»å…¬å¼€æ•°æ®æºï¼ˆå¦‚Natural Earthæˆ–GSHHGï¼‰ä¸‹è½½ä¸­å›½æµ·å²¸çº¿çš„çŸ¢é‡æ•°æ®ï¼ˆé€šå¸¸æ˜¯Shapefileæ ¼å¼ï¼‰ã€‚
2. **å®šä¹‰ç½‘æ ¼èŒƒå›´**ï¼šæ ¹æ®ä¸­å›½æµ·å²¸çº¿çš„å¤§è‡´èŒƒå›´ï¼ˆç»çº¬åº¦èŒƒå›´ï¼‰ï¼Œç”Ÿæˆ0.01åº¦ç²¾åº¦çš„ç½‘æ ¼ã€‚
3. **ç½‘æ ¼ä¸æµ·å²¸çº¿ç›¸äº¤**ï¼šåˆ¤æ–­æ¯ä¸ªç½‘æ ¼å•å…ƒæ˜¯å¦ä¸æµ·å²¸çº¿ç›¸äº¤ï¼Œæˆ–è€…æ˜¯å¦å±äºé™†åœ°/æµ·æ´‹ã€‚
4. **ä¿å­˜ç»“æœ**ï¼šå°†ç”Ÿæˆçš„ç½‘æ ¼æ•°æ®ä¿å­˜ä¸ºåœ°ç†æ•°æ®æ ¼å¼ï¼ˆå¦‚Shapefileæˆ–GeoJSONï¼‰ã€‚

---

### æ‰€éœ€åº“
åœ¨å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿å®‰è£…ä»¥ä¸‹Pythonåº“ï¼š
```bash
pip install geopandas shapely numpy matplotlib
```

---

### å…·ä½“å®ç°ä»£ç 

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„Pythonä»£ç ç¤ºä¾‹ï¼Œç”¨äºç”Ÿæˆé«˜ç²¾åº¦ä¸­å›½æµ·å²¸çº¿ç½‘æ ¼æ•°æ®ï¼š

```python
import geopandas as gpd
import numpy as np
from shapely.geometry import Polygon
import matplotlib.pyplot as plt

# 1. åŠ è½½ä¸­å›½æµ·å²¸çº¿æ•°æ®
# ä¸‹è½½Natural Earthæ•°æ®ï¼ˆ10måˆ†è¾¨ç‡ï¼‰æˆ–GSHHGæ•°æ®ï¼Œå¹¶è§£å‹åˆ°æœ¬åœ°
# è¿™é‡Œå‡è®¾ä½ å·²ä¸‹è½½å¹¶è§£å‹äº†Natural Earthçš„æµ·å²¸çº¿æ•°æ®
coastline_file = "path_to_natural_earth/ne_10m_coastline.shp"  # è¯·æ›¿æ¢ä¸ºå®é™…è·¯å¾„
coastline_gdf = gpd.read_file(coastline_file)

# 2. å®šä¹‰ä¸­å›½æµ·å²¸çº¿çš„ç»çº¬åº¦èŒƒå›´ï¼ˆå¤§è‡´èŒƒå›´ï¼Œå¯æ ¹æ®éœ€è¦è°ƒæ•´ï¼‰
min_lon, max_lon = 100, 135  # ç»åº¦èŒƒå›´
min_lat, max_lat = 15, 55     # çº¬åº¦èŒƒå›´

# 3. ç”Ÿæˆ0.01åº¦ç²¾åº¦çš„ç½‘æ ¼
grid_resolution = 0.01  # ç½‘æ ¼ç²¾åº¦
lon_grid = np.arange(min_lon, max_lon, grid_resolution)
lat_grid = np.arange(min_lat, max_lat, grid_resolution)

# åˆ›å»ºç½‘æ ¼å•å…ƒçš„åˆ—è¡¨
grid_polygons = []
for lon in lon_grid:
    for lat in lat_grid:
        # å®šä¹‰æ¯ä¸ªç½‘æ ¼å•å…ƒçš„å››è¾¹å½¢
        grid_poly = Polygon([
            (lon, lat),
            (lon + grid_resolution, lat),
            (lon + grid_resolution, lat + grid_resolution),
            (lon, lat + grid_resolution)
        ])
        grid_polygons.append(grid_poly)

# å°†ç½‘æ ¼å•å…ƒè½¬æ¢ä¸ºGeoDataFrame
grid_gdf = gpd.GeoDataFrame(geometry=grid_polygons, crs=coastline_gdf.crs)

# 4. åˆ¤æ–­ç½‘æ ¼æ˜¯å¦ä¸ä¸­å›½æµ·å²¸çº¿ç›¸äº¤
# ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå¯ä»¥å…ˆå¯¹ä¸­å›½æµ·å²¸çº¿æ•°æ®è¿›è¡Œè£å‰ªï¼Œä»…ä¿ç•™ä¸­å›½é™„è¿‘åŒºåŸŸ
china_coastline = coastline_gdf.cx[min_lon:max_lon, min_lat:max_lat]

# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­ç½‘æ ¼æ˜¯å¦ä¸æµ·å²¸çº¿ç›¸äº¤
def is_coastal(grid_geom, coastline_gdf):
    for coastline_geom in coastline_gdf.geometry:
        if grid_geom.intersects(coastline_geom):
            return True
    return False

# åº”ç”¨å‡½æ•°ï¼Œæ ‡è®°æµ·å²¸çº¿ç½‘æ ¼
grid_gdf['is_coastal'] = grid_gdf.geometry.apply(lambda x: is_coastal(x, china_coastline))

# 5. è¿‡æ»¤å‡ºæµ·å²¸çº¿ç½‘æ ¼ï¼ˆåªä¿ç•™ä¸æµ·å²¸çº¿ç›¸äº¤çš„ç½‘æ ¼ï¼‰
coastal_grid_gdf = grid_gdf[grid_gdf['is_coastal']]

# 6. å¯è§†åŒ–ç»“æœï¼ˆå¯é€‰ï¼‰
fig, ax = plt.subplots(figsize=(10, 10))
china_coastline.plot(ax=ax, color='blue', linewidth=1, label='Coastline')
coastal_grid_gdf.plot(ax=ax, color='red', alpha=0.3, label='Coastal Grid')
plt.title("China Coastal Grid (0.01Â° Resolution)")
plt.legend()
plt.show()

# 7. ä¿å­˜ç»“æœä¸ºShapefileæˆ–GeoJSON
output_file = "china_coastal_grid.shp"  # è¾“å‡ºæ–‡ä»¶è·¯å¾„
coastal_grid_gdf.to_file(output_file)
print(f"Coastal grid data saved to {output_file}")
```

---

### ä»£ç è¯´æ˜

1. **åŠ è½½æµ·å²¸çº¿æ•°æ®**ï¼š
   - ä½¿ç”¨`geopandas`è¯»å–æµ·å²¸çº¿æ•°æ®ï¼ˆShapefileæ ¼å¼ï¼‰ã€‚
   - æ•°æ®æºæ¨èï¼š
     - **Natural Earth**ï¼šæä¾›å…è´¹çš„å…¨çƒæµ·å²¸çº¿çŸ¢é‡æ•°æ®ï¼Œåˆ†è¾¨ç‡æœ‰10mã€50mã€110må¯é€‰ã€‚ä¸‹è½½åœ°å€ï¼šhttps://www.naturalearthdata.com/downloads/
     - **GSHHG**ï¼šæä¾›æ›´é«˜åˆ†è¾¨ç‡çš„å…¨çƒæµ·å²¸çº¿æ•°æ®ï¼Œé€‚åˆé«˜ç²¾åº¦éœ€æ±‚ã€‚ä¸‹è½½åœ°å€ï¼šhttps://www.soest.hawaii.edu/pwessel/gshhg/

2. **å®šä¹‰ç½‘æ ¼èŒƒå›´**ï¼š
   - æ ¹æ®ä¸­å›½æµ·å²¸çº¿çš„å¤§è‡´ç»çº¬åº¦èŒƒå›´ï¼ˆè¿™é‡Œè®¾ç½®ä¸º100Â°E-135Â°Eï¼Œ15Â°N-55Â°Nï¼‰ï¼Œç”Ÿæˆ0.01åº¦ç²¾åº¦çš„ç½‘æ ¼ã€‚
   - ä½¿ç”¨`numpy.arange`ç”Ÿæˆç»çº¬åº¦åºåˆ—ï¼Œç„¶åé€šè¿‡å¾ªç¯æ„é€ æ¯ä¸ªç½‘æ ¼å•å…ƒçš„å››è¾¹å½¢ï¼ˆ`Polygon`ï¼‰ã€‚

3. **åˆ¤æ–­ç½‘æ ¼ä¸æµ·å²¸çº¿ç›¸äº¤**ï¼š
   - ä½¿ç”¨`shapely`çš„å‡ ä½•è¿ç®—åŠŸèƒ½ï¼Œåˆ¤æ–­æ¯ä¸ªç½‘æ ¼å•å…ƒæ˜¯å¦ä¸æµ·å²¸çº¿ç›¸äº¤ã€‚
   - ä¸ºæé«˜æ•ˆç‡ï¼Œå…ˆå¯¹æµ·å²¸çº¿æ•°æ®è¿›è¡Œç©ºé—´è£å‰ªï¼ˆ`cx`æ–¹æ³•ï¼‰ï¼Œä»…ä¿ç•™ä¸­å›½é™„è¿‘åŒºåŸŸçš„æµ·å²¸çº¿ã€‚

4. **ä¿å­˜å’Œå¯è§†åŒ–**ï¼š
   - å°†ç»“æœä¿å­˜ä¸ºShapefileæˆ–GeoJSONæ ¼å¼ï¼Œæ–¹ä¾¿åœ¨GISè½¯ä»¶ï¼ˆå¦‚QGISï¼‰ä¸­è¿›ä¸€æ­¥å¤„ç†ã€‚
   - ä½¿ç”¨`matplotlib`ç»˜åˆ¶æµ·å²¸çº¿å’Œç½‘æ ¼çš„å¯è§†åŒ–å›¾ï¼Œä»¥ä¾¿ç›´è§‚æ£€æŸ¥ç»“æœã€‚

---

### æ³¨æ„äº‹é¡¹

1. **æ•°æ®åˆ†è¾¨ç‡**ï¼š
   - å¦‚æœéœ€è¦æ›´é«˜ç²¾åº¦çš„æµ·å²¸çº¿æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨GSHHGæ•°æ®ï¼ˆåˆ†è¾¨ç‡å¯è¾¾å‡ ç±³ï¼‰ï¼Œè€ŒéNatural Earthï¼ˆåˆ†è¾¨ç‡è¾ƒä½ï¼‰ã€‚
   - GSHHGæ•°æ®éœ€è¦é¢å¤–å¤„ç†ï¼ˆä¾‹å¦‚è½¬æ¢ä¸ºShapefileæ ¼å¼ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨`ogr2ogr`å·¥å…·æˆ–Pythonåº“`fiona`è¿›è¡Œè½¬æ¢ã€‚

2. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - å¦‚æœç½‘æ ¼èŒƒå›´è¾ƒå¤§æˆ–ç²¾åº¦è¾ƒé«˜ï¼ˆå¦‚0.01åº¦ï¼‰ï¼Œç½‘æ ¼æ•°é‡ä¼šéå¸¸å¤šï¼Œå¯èƒ½å¯¼è‡´è®¡ç®—æ•ˆç‡ä½ä¸‹ã€‚
   - å¯ä»¥ä½¿ç”¨ç©ºé—´ç´¢å¼•ï¼ˆå¦‚`rtree`ï¼‰æ¥åŠ é€Ÿå‡ ä½•ç›¸äº¤è¿ç®—ï¼š
     ```bash
     pip install rtree
     ```
     ç„¶ååœ¨ä»£ç ä¸­å¯ç”¨ç©ºé—´ç´¢å¼•ï¼š
     ```python
     from rtree import index
     ```

3. **é™†åœ°/æµ·æ´‹åŒºåˆ†**ï¼š
   - å¦‚æœéœ€è¦è¿›ä¸€æ­¥åŒºåˆ†ç½‘æ ¼å•å…ƒæ˜¯é™†åœ°è¿˜æ˜¯æµ·æ´‹ï¼Œå¯ä»¥ä½¿ç”¨é¢å¤–çš„é™†åœ°å¤šè¾¹å½¢æ•°æ®ï¼ˆå¦‚Natural Earthçš„é™†åœ°æ•°æ®ï¼‰è¿›è¡Œç©ºé—´å åŠ åˆ†æã€‚

4. **æŠ•å½±é—®é¢˜**ï¼š
   - ä»£ç ä¸­ä½¿ç”¨çš„æ˜¯ç»çº¬åº¦åæ ‡ç³»ï¼ˆWGS84ï¼‰ã€‚å¦‚æœéœ€è¦æŠ•å½±åˆ°å…¶ä»–åæ ‡ç³»ï¼ˆå¦‚UTMï¼‰ï¼Œå¯ä»¥åœ¨ä¿å­˜ç»“æœå‰ä½¿ç”¨`geopandas`çš„`to_crs`æ–¹æ³•è¿›è¡ŒæŠ•å½±è½¬æ¢ã€‚

---

### è¾“å‡ºç»“æœ
è¿è¡Œä¸Šè¿°ä»£ç åï¼Œä½ å°†å¾—åˆ°ä»¥ä¸‹è¾“å‡ºï¼š
- ä¸€ä¸ªShapefileæ–‡ä»¶ï¼ˆ`china_coastal_grid.shp`ï¼‰ï¼ŒåŒ…å«ä¸ä¸­å›½æµ·å²¸çº¿ç›¸äº¤çš„ç½‘æ ¼å•å…ƒã€‚
- æ¯ä¸ªç½‘æ ¼å•å…ƒçš„å‡ ä½•ä¿¡æ¯å’Œæ˜¯å¦ä¸ºæµ·å²¸çº¿çš„æ ‡è®°ï¼ˆ`is_coastal`å­—æ®µï¼‰ã€‚
- å¯è§†åŒ–å›¾å½¢ï¼Œå±•ç¤ºæµ·å²¸çº¿å’Œç½‘æ ¼çš„å åŠ æ•ˆæœã€‚

---

### æ‰©å±•åº”ç”¨
1. **æé«˜ç²¾åº¦**ï¼š
   - å¦‚æœéœ€è¦æ›´é«˜çš„ç½‘æ ¼ç²¾åº¦ï¼ˆå¦‚0.001åº¦ï¼‰ï¼Œåªéœ€è°ƒæ•´`grid_resolution`çš„å€¼ï¼Œä½†è¦æ³¨æ„è®¡ç®—èµ„æºå’Œå­˜å‚¨ç©ºé—´çš„éœ€æ±‚ä¼šæ˜¾è‘—å¢åŠ ã€‚

2. **æ·»åŠ å±æ€§**ï¼š
   - å¯ä»¥ä¸ºæ¯ä¸ªç½‘æ ¼å•å…ƒæ·»åŠ é¢å¤–çš„å±æ€§ï¼Œä¾‹å¦‚è·ç¦»æµ·å²¸çº¿çš„è·ç¦»ã€ç½‘æ ¼ä¸­å¿ƒç‚¹çš„ç»çº¬åº¦ç­‰ã€‚

3. **å¹¶è¡Œè®¡ç®—**ï¼š
   - å¦‚æœç½‘æ ¼æ•°é‡è¿‡å¤šï¼Œå¯ä»¥ä½¿ç”¨`multiprocessing`æˆ–`dask`è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œä»¥æé«˜æ•ˆç‡ã€‚

---

é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ å¯ä»¥ç”Ÿæˆé«˜ç²¾åº¦çš„ä¸­å›½æµ·å²¸çº¿ç½‘æ ¼æ•°æ®ï¼Œå¹¶æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œæ‰©å±•å’Œä¼˜åŒ–ã€‚å¦‚æœæœ‰è¿›ä¸€æ­¥é—®é¢˜ï¼Œæ¬¢è¿ç»§ç»­æé—®ï¼